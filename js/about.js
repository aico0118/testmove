/*! webMini 2019-04-27 */
Core={siteversion:"NO VERSION",namespace:"donkeymove",release:1,config:{bookingday:{min:{day:1,hour:12}},bookingcancelday:{min:{day:1,hour:12}},accompany:2,subsidemax:8,pusherkey:"e241c309b975ba1708b2",pushercluster:"ap1"},showLog:function(a){0==Core.release&&console.log(a)},showError:function(a){0==Core.release&&(alert(a),console.log(a))},getGUID:function(){for(var a="",b=1;32>=b;b++){var c=Math.floor(16*Math.random()).toString(16);a+=c,(8==b||12==b||16==b||20==b)&&(a+="-")}return a},requireJS:function(a,b,c){if(void 0!=a&&a.length>5){var d=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript",e.readyState?e.onreadystatechange=function(){("loaded"==e.readyState||"complete"==e.readyState)&&(e.onreadystatechange=null,b&&b(a))}:(e.onload=function(){b&&b(a)},c&&(e.onerror=c)),e.src=a,d.appendChild(e)}},extend:function(a,b,c){var d=function(){};d.prototype=b.prototype,a.prototype=new d,a.prototype.constructor=a,a.superclass=b.prototype,a.prototype.Events=c,b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b)},createStyle:function(a,b){var c=document.createElement("style");return c.type="text/css",c.innerHTML=a+b,document.getElementsByTagName("head")[0].appendChild(c),c},createScriptFromContent:function(a){var b=document.createElement("script");return b.type="text/javascript",b.innerText=a,document.getElementsByTagName("head")[0].appendChild(b),b},createScriptFromSrc:function(a){var b=document.createElement("script");return b.type="text/javascript",b.src=a,document.getElementsByTagName("head")[0].appendChild(b),b},loadJSandCSS:function(a,b){var c=document.getElementsByTagName("head")[0];if(void 0!=a&&a.length>5){var d=document.createElement("script");d.type="text/javascript",d.src=a,c.appendChild(d)}if(void 0!=b&&b.length>5){var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=b,c.appendChild(e)}},destroyStyleObject:function(a){void 0!=a&&void 0!=a.style&&($(a.style).remove(),delete a.style,a.style=void 0)},destroyElement:function(a){void 0!=a&&(a.remove(),a=void 0)},destroyObject:function(a){void 0!==a&&(a=void 0)},jsonEscape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\/]/g,"\\/").replace(/[\b]/g,"\\b").replace(/[\f]/g,"\\f").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t")},stringToObject:function(a,b){b=b||"object";for(var c=a.split("."),d=window||this,e=0,f=c.length;f>e;e++)try{d=d[c[e]]}catch(g){return}return typeof d!==b?void 0:d},cloneJSON:function(a){if(null===a||void 0===a||"object"!=typeof a)return a;if(a instanceof Array){for(var b=[],c=0;c<a.length;++c)b[c]=Core.cloneJSON(a[c]);return b}var d={};for(var c in a)d[c]=Core.cloneJSON(a[c]);return d}},function(a){a.event.special.destroyed={remove:function(a){a.handler&&a.handler()}}}(jQuery),Core.Interface=function(a,b){if(2!=arguments.length)throw new Error("the interface length is bigger than 2");this.Name=a,this.Method=[];for(var c=0;c<b.length;c++){if("string"!=typeof b[c])throw new Error("the method name is not string");this.Method.push(b[c])}},Core.Interface.ensureImplement=function(a){if(arguments.length<2)throw new Error("there is not Interface or the instance");for(var b=1;b<arguments.length;b++)for(var c=arguments[b],d=0;d<c.Method.length;d++){var e=c.Method[d];if(!a[e]||"function"!=typeof a[e])throw new Error("you instance doesn't implement the interface")}},Core.iEvent=function(){this.eventHandlers=new Array},Core.iEvent.prototype.addHandler=function(a){this.eventHandlers.push(a)},Core.iEvent.prototype.execute=function(a){for(var b=0;b<this.eventHandlers.length;b++)this.eventHandlers[b](a)},Core.iEvent.prototype.removeHandler=function(a){for(var b=0;b<this.eventHandlers.length;b++)if(this.eventHandlers[b]==a){this.eventHandlers.splice(b,1);break}},Core.ModuleLoader=function(){this.LoadModule=function(a,b,c){a.modules.push("js/plugins/pusher/pusher"+("https:"==document.location.protocol?"https":"http")+".min.js"),a.classes.push({par:"Core",name:"Pusher"}),require(a.modules,function(){for(var d=!1,e=0;e<a.classes.length;e++){var f=Core.stringToObject(a.classes[e].par);if(!f){c({category:"parent missed",msg:a.classes[e].par}),d=!0;break}f[a.classes[e].name]=arguments[e]}SystemConfig.pusher.Start(),b()},function(a){0==Core.release&&alert("load failed"),c({category:"load failed",err:a})})},this.LoadLanguage=function(a,b,c,d){(""===a||void 0===a||null===a)&&(a="zh-tw"),SystemConfig.browserProfile=Core.Utility.Utility.BrowserHelper.getBrowserProfile(),require(["json!"+b+a.toLowerCase()+".json"],function(a){c(a)},function(c){0==Core.release&&alert("load language failed"),d(b+a.toLowerCase()+".json")})}},Core.iObject=function(){this.Events&&this.setEventHandler(this.Events)},Core.iObject.prototype={addEventListener:function(a,b){if(void 0!=this.events[a]){for(var c=!1,d=0;d<this.events[a].eventHandlers.length;d++)if(b==this.events[a].eventHandlers[d]){c=!0;break}c||this.events[a].addHandler(b)}},execute:function(a,b){void 0!=this.events[a]&&this.events[a].execute(b)},removeEventListener:function(a,b){void 0!=this.events[a]&&this.events[a].removeHandler(b)},setEventHandler:function(a){void 0==this.events&&(this.events={});for(var b in a)void 0==this.events[b]&&(this.events[b]=new Core.iEvent)},clearEventHandler:function(a){for(var b in this.events)this.events[b]=new Core.iEvent}},Core.DisplayType={center:1,offset:2,heightoffset:3},Core.DisplayArea=function(a){var b=this;this.attrs={},$.extend(this.attrs,a),this.getCss=function(){return $.extend({},b.attrs)},this.getDisplayArea=function(a,c){switch(c||(c=Core.DisplayType.center),c){case Core.DisplayType.offset:return new Core.DisplayArea({mode:c,left:b.attrs.width,width:a.attrs.width-2*b.attrs.width,top:b.attrs.height,height:a.attrs.height-2*b.attrs.height});case Core.DisplayType.heightoffset:return new Core.DisplayArea({mode:c,left:(a.attrs.width-b.attrs.width)/2,width:b.attrs.width,top:b.attrs.top,bottom:b.attrs.bottom});case Core.DisplayType.center:var d={mode:c,width:b.attrs.width,height:b.attrs.height};return a.attrs.width>b.attrs.width?d.left=(a.attrs.width-b.attrs.width)/2:(d.left=30,b.attrs.width=a.attrs.width-60),a.attrs.height>b.attrs.height?d.top=(a.attrs.height-b.attrs.height)/2:(d.top=30,b.attrs.height=a.attrs.height-60),new Core.DisplayArea(d)}}},Date.prototype.getMonthDays=function(){var a=this,b=a.getFullYear(),c=a.getMonth(),d=b%4==0&&(b%100!=0||b%400==0);return[31,d?29:28,31,30,31,30,31,31,30,31,30,31][c]},Date.prototype.getWeekByToday=function(){var a=new Date(this.getTime());a.setHours(0,0,0,0),a.setDate(a.getDate()+3-(a.getDay()+6)%7);var b=new Date(a.getFullYear(),0,4);return 1+Math.round(((a.getTime()-b.getTime())/864e5-3+(b.getDay()+6)%7)/7)},Date.prototype.getWeekYearByToday=function(){var a=new Date(this.getTime());return a.setDate(a.getDate()+3-(a.getDay()+6)%7),a.getFullYear()},Date.prototype.getWeekNumberByDate=function(a){a=new Date(+a),a.setHours(0,0,0),a.setDate(a.getDate()+4-(a.getDay()||7));var b=new Date(a.getFullYear(),0,1),c=Math.ceil(((a-b)/864e5+1)/7);return[a.getFullYear(),c]},Date.prototype.getWeekCountByYear=function(a){var b,c=11,e=31;do d=new Date(a,c,e--),b=d.getWeekNumberByDate(d)[1];while(1==b);return b},Date.prototype.format=function(a){var b=this,c=function(a,b){b||(b=2),a=String(a);for(var c=0,d="";c<b-a.length;c++)d+="0";return d+a};return a.replace(/"[^"]*"|'[^']*'|\b(?:d{1,4}|m{1,4}|yy(?:yy)?|([hHMstT])\1?|[lLZ])\b/g,function(a){switch(a){case"d":return b.getDate();case"dd":return c(b.getDate());case"ddd":return["Sun","Mon","Tue","Wed","Thr","Fri","Sat"][b.getDay()];case"dddd":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][b.getDay()];case"M":return b.getMonth()+1;case"MM":return c(b.getMonth()+1);case"MMM":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getMonth()];case"MMMM":return["January","February","March","April","May","June","July","August","September","October","November","December"][b.getMonth()];case"yy":return String(b.getFullYear()).substr(2);case"yyyy":return b.getFullYear();case"h":return b.getHours()%12||12;case"hh":return 0==b.getHours()?"00":c(b.getHours()%12||12);case"H":return b.getHours();case"HH":return c(b.getHours());case"m":return b.getMinutes();case"mm":return c(b.getMinutes());case"s":return b.getSeconds();case"ss":return c(b.getSeconds());case"l":return c(b.getMilliseconds(),3);case"L":var d=b.getMilliseconds();return d>99&&(d=Math.round(d/10)),c(d);case"tt":return b.getHours()<12?"am":"pm";case"TT":return b.getHours()<12?"AM":"PM";case"Z":return b.toUTCString().match(/[A-Z]+$/);default:return a.substr(1,a.length-2)}})},Date.prototype.getWeekNumber=function(){var a=new Date(+this);return a.setHours(0,0,0),a.setDate(a.getDate()+4-(a.getDay()||7)),Math.ceil(((a-new Date(a.getFullYear(),0,1))/864e5+1)/7)},Core.BaseControl=function(){function a(){b.Override_DestroyContainer&&b.Override_DestroyContainer()}var b=this;Core.BaseControl.superclass.constructor.call(this);var c={id:"ictxt_"+Core.getGUID()},d=void 0,e=void 0;this._getID=function(){return c.id},this._setID=function(a){c.id=a},this._initCtlAttr=function(a){try{for(var b in a)c[b]=a[b]}catch(d){}},this._setCtlAttr=function(a,b){c.hasOwnProperty(a)&&(c[a]=b)},this._getCtlAttr=function(a){return void 0!=c[a]?c[a]:void 0},this._setParent=function(a){d=a},this._getParent=function(){return d},this._showParent=function(){d&&d.show()},this._hideParent=function(){d&&d.hide()},this._removeParent=function(){d&&d.remove()},this._setParentCss=function(a){d&&d.css(a)},this._createContainer=function(b,d,f,g){return e=$(b).attr("id",c.id),d&&e.addClass(d),f&&e.css(f),g&&e.attr(g),e.bind("destroyed",a),e},this._getContainer=function(a,b,c){return e?(a&&e.addClass(a),b&&e.css(b),c&&e.attr(c),e):void 0},this._removeContainer=function(){e&&e.remove()},this._addToParent=function(){e&&d&&e.appendTo(d)},this._preToParent=function(){e&&d&&e.prependTo(d)},this._show=function(){e&&e.show()},this._hide=function(){e&&e.hide()},this._addClass=function(a){e&&e.addClass(a)},this._removeClass=function(a){e&&e.removeClass(a)},this._setCss=function(a){e&&e.css(a)},this._setAttrs=function(a){e&&e.attr(a)},this._getAttrs=function(){return e?e.attr():void 0},this._setAttr=function(a,b){e&&e.attr(a,b)},this._getAttr=function(a){return e?e.attr(a):void 0},this._setTop=function(a){e&&e.css("top",a)},this._getTop=function(){return e?e.position().top:void 0},this._setLeft=function(a){e&&e.css("left",a)},this._getLeft=function(){return e?e.position().left:void 0},this._setPosition=function(a,b){if(e){var c=b?b:{x:1,y:1};e.css({left:a.left*c.x,top:a.top*c.y})}},this._getPosition=function(){return e?{left:e.position().left,top:e.position().top}:void 0},this._setWidth=function(a){e&&e.css("width",a)},this._getWidth=function(){return e?e.width():void 0},this._setHeight=function(a){e&&e.css("height",a)},this._getHeight=function(){return e?e.height():void 0},this._setZindex=function(a){e&&e.zIndex(a)},this._getZindex=function(){return e?e.zIndex():-1},this._isVisible=function(){return e.is(":visible")}},Core.extend(Core.BaseControl,Core.iObject),Core.BaseControl.prototype.getID=function(){return this._getID()},Core.BaseControl.prototype.setID=function(a){this._setID(a)},Core.BaseControl.prototype.initCtlAttr=function(a){this._initCtlAttr(a)},Core.BaseControl.prototype.setCtlAttr=function(a,b){this._setCtlAttr(a,b)},Core.BaseControl.prototype.getCtlAttr=function(a){return this._getCtlAttr(a)},Core.BaseControl.prototype.setParent=function(a){this._setParent(a)},Core.BaseControl.prototype.getParent=function(){return this._getParent()},Core.BaseControl.prototype.removeParent=function(){this._removeParent()},Core.BaseControl.prototype.showParent=function(){this._showParent()},Core.BaseControl.prototype.hideParent=function(){this._hideParent()},Core.BaseControl.prototype.setParentCss=function(a){this._setParentCss(a)},Core.BaseControl.prototype.createContainer=function(a,b,c,d){return this._createContainer(a,b,c,d)},Core.BaseControl.prototype.addToParent=function(){this._addToParent()},Core.BaseControl.prototype.preToParent=function(){this._preToParent()},Core.BaseControl.prototype.show=function(){this._show()},Core.BaseControl.prototype.hide=function(){this._hide()},Core.BaseControl.prototype.getContainer=function(a,b,c){return this._getContainer(a,b,c)},Core.BaseControl.prototype.removeContainer=function(){this._removeContainer()},Core.BaseControl.prototype.addClass=function(a){this._addClass(a)},Core.BaseControl.prototype.removeClass=function(a){this._removeClass(a)},Core.BaseControl.prototype.css=function(a){this._setCss(a)},Core.BaseControl.prototype.setAttrs=function(a){this._setAttrs(a)},Core.BaseControl.prototype.getAttrs=function(){this._getAttrs(attrs)},Core.BaseControl.prototype.setAttr=function(a,b){this._setAttr(a,b)},Core.BaseControl.prototype.getAttr=function(a){return this._getAttr(a)},Core.BaseControl.prototype.setLeft=function(a){this._setLeft(a)},Core.BaseControl.prototype.getLeft=function(){return this._getLeft()},Core.BaseControl.prototype.setTop=function(a){this._setTop(a)},Core.BaseControl.prototype.getTop=function(){return this._getTop()},Core.BaseControl.prototype.setPosition=function(a,b){this._setPosition(a,b)},Core.BaseControl.prototype.getPosition=function(){return this._getPosition()},Core.BaseControl.prototype.setWidth=function(a){this._setWidth(a)},Core.BaseControl.prototype.getWidth=function(){return this._getWidth()},Core.BaseControl.prototype.setHeight=function(a){this._setHeight(a)},Core.BaseControl.prototype.getHeight=function(){return this._getHeight()},Core.BaseControl.prototype.setZindex=function(a){this._setZindex(a)},Core.BaseControl.prototype.getZindex=function(){return this._getZindex()},Core.BaseControl.prototype.isVisible=function(){return this._isVisible()},Core.TaskEvent=function(){var a=this;Core.TaskEvent.superclass.constructor.call(this),this.RegisterEvent=function(b){var c={};$.each(b,function(a){c[a]=new Core.iEvent}),$.extend(a.events,c)}},Core.extend(Core.TaskEvent,Core.iObject,{}),Core.SystemEventHandler=function(){var a=this;Core.SystemEventHandler.superclass.constructor.call(this),$(window).resize(function(){a.execute("OnWindowResize","")})},Core.extend(Core.SystemEventHandler,Core.BaseControl,{OnWindowResize:""}),Date.prototype.getMonthDays=function(){var a=this,b=a.getFullYear(),c=a.getMonth(),d=b%4==0&&(b%100!=0||b%400==0);return[31,d?29:28,31,30,31,30,31,31,30,31,30,31][c]},Date.prototype.format=function(a){var b=this,c=function(a,b){b||(b=2),a=String(a);for(var c=0,d="";c<b-a.length;c++)d+="0";return d+a};return a.replace(/"[^"]*"|'[^']*'|\b(?:d{1,4}|m{1,4}|yy(?:yy)?|([hHMstT])\1?|[lLZ])\b/g,function(a){switch(a){case"d":return b.getDate();case"dd":return c(b.getDate());case"ddd":return["Sun","Mon","Tue","Wed","Thr","Fri","Sat"][b.getDay()];case"dddd":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][b.getDay()];case"M":return b.getMonth()+1;case"MM":return c(b.getMonth()+1);case"MMM":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getMonth()];case"MMMM":return["January","February","March","April","May","June","July","August","September","October","November","December"][b.getMonth()];case"yy":return String(b.getFullYear()).substr(2);case"yyyy":return b.getFullYear();case"h":return b.getHours()%12||12;case"hh":return 0==b.getHours()?"00":c(b.getHours()%12||12);case"H":return b.getHours();case"HH":return c(b.getHours());case"m":return b.getMinutes();case"mm":return c(b.getMinutes());case"s":return b.getSeconds();case"ss":return c(b.getSeconds());case"l":return c(b.getMilliseconds(),3);case"L":var d=b.getMilliseconds();return d>99&&(d=Math.round(d/10)),c(d);case"tt":return b.getHours()<12?"am":"pm";case"TT":return b.getHours()<12?"AM":"PM";case"Z":return b.toUTCString().match(/[A-Z]+$/);default:return a.substr(1,a.length-2)}})},Date.prototype.getWeekNumber=function(){var a=new Date(+this);return a.setHours(0,0,0),a.setDate(a.getDate()+4-(a.getDay()||7)),Math.ceil(((a-new Date(a.getFullYear(),0,1))/864e5+1)/7)},Core.GMapHelper={key:"AIzaSyDl-m9a3emc8ju1U8Pu_qm6f-oTY6d_1jg",loadmap:function(a,b,c){var d="";if(a)for(key in a)d="&"+key+"="+a[key];require(["async!//maps.google.com/maps/api/js?sensor=false&key="+Core.GMapHelper.key+"&language=zh-TW"+d],function(){Core.Control.Map=google.maps,b()},function(a){c(a)})},getmap:function(a,b){var c={zoom:16};b&&Core.Utility.Utility.JSONHelper.AssignValue(c,b,!0);var d=new Core.Control.Map.Map(a,c);return d},setcurrentasmapcenter:function(a){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(b){initialLocation=new google.maps.LatLng(b.coords.latitude,b.coords.longitude),a.setCenter(initialLocation)})},setmapcenter:function(a,b){a.setCenter(b)},getlatlngbyaddr:function(a,b,c){var d=new google.maps.Geocoder;d.geocode({address:b},function(b,d){d==google.maps.GeocoderStatus.OK&&c({index:a,latlng:{lat:b[0].geometry.location.lat(),lng:b[0].geometry.location.lng()}})})},getcoordinationbyaddr:function(a,b){for(var c=0,d=[],e=new google.maps.Geocoder,f=0;f<a.length;f++)e.geocode({address:a[f].address},function(e,f){f==google.maps.GeocoderStatus.OK&&(d.push({alat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng()}),c++,c==a.length&&b(d))})}},Core.ChartColors=["#f1cf63","#66a0e7","#e07085","#0abab5","#cacbcf","#8e6cfa","#e8a44d","#d4553d","#3700b3","#018786","#767676","#795548","#ff9800","#f44336","#cddc39","#3f51b5"],Core.getChartColor=function(a){return Core.ChartColors[a%Core.ChartColors.length]},Core.DownloadItem=function(){function a(a){a.stopPropagation(),c.execute("OnCancel",c),c.removeContainer()}function b(a){a.stopPropagation();var b=d.url.url+"?guid="+d.key+"&filename="+encodeURIComponent(d.filename)+"&token="+SystemConfig.UserProfile.getToken();if("SAFARI"==SystemConfig.browserProfile.name.toUpperCase()){var e=window.open(b);if(null==e||"undefined"==typeof e){var f=new Core.Control.Dialogs.MessageDialog;f.ShowDialog("Unknown Error","error",[{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}])}else c.execute("OnDownload",c),c.removeContainer()}else window.open(b),c.execute("OnDownload",c),c.removeContainer()}var c=this;Core.DownloadItem.superclass.constructor.call(this);var d=void 0,e=void 0,f=void 0,g=void 0;this.Attach=function(b,c){d=c,this.setParent(b);var h=Core.DownloadItem.superclass.createContainer.call(this,"<div/>","downloadagent_item");e=$("<div/>").appendTo(h),$("<div/>").addClass("downloadagent_item_title").text(d.title).appendTo(e),$("<div/>").addClass("downloadagent_item_btn icon-cross").appendTo(e).click(a),f=$("<div/>").addClass("downloadagent_item_loading").appendTo(e),g=new Core.Control.Spinners.Spinner({css:{width:26,height:26,"line-height":"26px",fontSize:26,marginTop:-2}}),g.AttachSpinner(f),b.append(h)},this.GetKey=function(){return d.key},this.SetDownloadReady=function(){g&&(g.Stop(),delete g,g=void 0),f.remove(),$("<div/>").addClass("downloadagent_item_btn icon-dirarrow-down").appendTo(e).click(b)}},Core.extend(Core.DownloadItem,Core.BaseControl,{OnCancel:"",OnDownload:""}),Core.DownloadAgent=function(){function a(a){var b=e.indexOf(a);b>-1&&e.splice(b,1),e.length<1?f.hide():f.text(SystemConfig.localizationer.getString("COMMON_TEXT_0020")+e.length+SystemConfig.localizationer.getString("COMMON_TEXT_0021"))}function b(b){a(b)}function c(a){if("download"==a.action&&a.key)for(var b=0;b<e.length;b++)if(e[b].GetKey()==a.key){e[b].SetDownloadReady();break}}var d=this;Core.DownloadAgent.superclass.constructor.call(this);var e=[],f=void 0,g=void 0;this.Attach=function(a,b){g=b;var d=Core.DownloadAgent.superclass.createContainer.call(this,"<div/>","downloadagent_base");f=$("<div/>").addClass("downloadagent_header").text("Downloading").appendTo(d),SystemConfig.pusher.RegisterEvent("FileDownload_System",b,c),d.appendTo(a)},this.Deattach=function(){SystemConfig.pusher.UnRegisterEvent("FileDownload_System",g)},this.CreateDownload=function(c){for(var g=0;g<e.length;g++)if(e[g].GetKey()==c.key){var h=new Core.Control.Dialogs.MessageDialog;return h.ShowDialog(SystemConfig.localizationer.getString("COMMON_TEXT_0022"),"alert",[{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}]),!1}var i=new Core.DownloadItem;i.addEventListener("OnCancel",a),i.addEventListener("OnDownload",b),i.Attach(d.getContainer(),c),e.push(i),f.text(SystemConfig.localizationer.getString("COMMON_TEXT_0020")+e.length+SystemConfig.localizationer.getString("COMMON_TEXT_0021")).show()}},Core.extend(Core.DownloadAgent,Core.BaseControl,{OnSystemNotification:"",OnUpload:""}),Core.PusherAgent=function(){function a(a){Core.showLog("Global SystemChannel Get Message"),n(r[0],a)}function b(a){Core.showLog("SP Get Message"),n(r[5],a)}function c(a){Core.showLog("Staff SystemChannel Get Message"),n(r[1],a)}function d(a){Core.showLog("Car SystemChannel Get Message"),n(r[3],a)}function e(a){Core.showLog("Driver SystemChannel Get Message"),n(r[4],a)}function f(a){Core.showLog("Fleet SystemChannel Get Message"),n(r[2],a)}function g(a){Core.showLog("Case SystemChannel Get Message"),n(r[6],a)}function h(a){Core.showLog("Shipment SystemChannel Get Message"),n(r[7],a)}function i(a){Core.showLog("Booking SystemChannel Get Message"),n(r[8],a)}function j(a){Core.showLog("PaidFee SystemChannel Get Message"),n(r[9],a)}function k(a){Core.showLog("User Profile SystemChannel Get Message"),n(r[10],a)}function l(a){Core.showLog("File Download SystemChannel Get Message"),n(r[11],a)}function b(a){Core.showLog("SP SystemChannel Get Message"),n(r[12],a)}function m(a){Core.showLog("Hospital SystemChannel Get Message"),n(r[13],a)}function n(a,b){if(a)for(var c=0;c<a.clients.length;c++)a.clients[c].ondata&&a.clients[c].ondata(b)}var o=this;Core.PusherAgent.superclass.constructor.call(this);var p={key:Core.config.pusherkey,cluster:Core.config.pushercluster},q=void 0;this.Start=function(){Core.showLog("Initialize pusher engine"),q=new Pusher(p.key,{cluster:p.cluster,encrypted:!1});for(var a=0;a<r.length;a++)r[a].channel=q.subscribe(r[a].name),r[a].channel.bind("update",r[a].ondata);o.execute("OnAgentStart")},this.Stop=function(){for(var a=0;a<r.length;a++)r[a].channel&&(q.unsubscribe(r[a].channel),delete r[a].channel);o.execute("OnAgentStop")},this.RegisterEvent=function(a,b,c){for(var d=0;d<r.length;d++)if(r[d].name.toUpperCase()==a.toUpperCase()){for(var e=!1,f=0;f<r[d].clients.length;f++)if(b.toUpperCase()==r[d].clients[f].id.toUpperCase())return Core.showLog("Register id:"+b),e=!0,0;if(!e)return r[d].clients.push({id:b,ondata:c}),1}return-1},this.UnRegisterEvent=function(a,b){for(var c=0;c<r.length;c++)if(r[c].name.toUpperCase()==a.toUpperCase()){for(var d=0;d<r[c].clients.length;d++)if(b.toUpperCase()==r[c].clients[d].id.toUpperCase())return Core.showLog("UnRegister id:"+b),r[c].clients.splice(d,1),1;return 0}return-1};var r=[{name:"Global_System",ondata:a,clients:[]},{name:"Staff_System",ondata:c,clients:[]},{name:"Fleet_System",ondata:f,clients:[]},{name:"Car_System",ondata:d,clients:[]},{name:"Driver_System",ondata:e,clients:[]},{name:"ServiceProvider_System",ondata:b,clients:[]},{name:"Case_System",ondata:g,clients:[]},{name:"Shipment_System",ondata:h,clients:[]},{name:"Booking_System",ondata:i,clients:[]},{name:"PaidFee_System",ondata:j,clients:[]},{name:"UserProfile_System",ondata:k,clients:[]},{name:"FileDownload_System",ondata:l,clients:[]},{name:"SP_System",ondata:b,clients:[]},{name:"HOS_System",ondata:m,clients:[]}]},Core.extend(Core.PusherAgent,Core.BaseControl,{}),Core.CopytoClipBoard=function(a){var b=$(this),c=document.createElement("textarea");c.value=b.data("clip"),document.body.appendChild(c),c.style.position="absolute",c.style.left="-9999px",c.style.width="1px",c.style.height="1px",c.select(),document.execCommand("copy");var d=new Core.Control.Dialogs.HintDialog;d.ShowDialog(SystemConfig.localizationer.getString("COMMON_TEXT_0013")),document.body.removeChild(c)},require.config({paths:{async:"plugins/requirejs/async",goog:"plugins/requirejs/goog",json:"plugins/requirejs/json",text:"plugins/requirejs/text",noext:"plugins/requirejs/noext"}}),Core.managemode={none:0,manage:1},Core.Control=Core.Control||{Forms:{},Controls:{},Cards:{}},Core.Utility={},Core.Data={Business:{}},SystemConfig={localizationer:void 0,localization:void 0,browserProfile:void 0,pusher:new Core.PusherAgent,mobiledevice:/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase())},SystemConfig.localizationer={getMonth:function(a){for(var b=[],c=1;12>=c;c++)b.push({id:c,title:SystemConfig.localizationer.getString("DatePicker_MonthNames_"+c)});if(!a)return b;for(var c=0;c<b.length;c++)if(b[c]==a)return b[c]},getString:function(a){if($.isArray(a)){for(var b="",c=0;c<a.length;c++)void 0!=SystemConfig.localization[a[c]]&&(b+=SystemConfig.localization[a[c]]);return b}return void 0!=SystemConfig.localization[a]?SystemConfig.localization[a]:""},getTemplateString:function(a,b){var c=SystemConfig.localization[a];if(c&&b&&$.isArray(b))for(var d=0;d<b.length;d++)c=c.replace("{%"+(d+1).toString()+"%}",b[d]);return c},showName:function(a){if(a.first&&a.last){var b=SystemConfig.localizationer.getString("USERNAME_0001");return b.replace("%LAST%",a.last).replace("%FIRST%",a.first)}return""},showTelephone:function(a){return a&&a.region?a.region+" "+a.phone:""},showLocalAddress:function(a){return a.city&&a.district&&a.street&&a.address?SystemConfig.localizationer.getString("ADDRESSFROMAT_001").replace("%CITY%",a.city).replace("%DISTRICT%",a.district).replace("%STREET%",a.street).replace("%ROAD%",a.address):""},showMoney:function(a,b){return a.currency&&!isNaN(a.money)?b?"<em>"+a.currency+"</em> "+a.money.toLocaleString("en"):a.currency+" "+a.money.toLocaleString("en"):void 0},getGenderTypes:function(a){var b=[{id:1,title:SystemConfig.localizationer.getString("GENDER_0001")},{id:2,title:SystemConfig.localizationer.getString("GENDER_0002")}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return{id:b[c].id,title:b[c].title}},getTransportingRoutes:function(a){var b=[{id:"round",title:"去程＋回程"},{id:"to",title:"去程"},{id:"back",title:"回程"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getTransportingRoutes2:function(a){var b=[{id:"to",title:"去程"},{id:"back",title:"回程"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return[b[c]]},"getＷheelChairTypes":function(a){var b=[{id:"2A9010B9703411E895E642010A000602",title:"標準輪椅"},{id:"2A9BFF4C703411E895E642010A000602",title:"高背輪椅"},{id:"2A9DDCF8703411E895E642010A000602",title:"電動輪椅"},{id:"2A9FC403703411E895E642010A000602",title:"電動高背輪椅"},{id:"0BFBEACAC6E111E8962942010A8C0FD5",title:"無"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getCarpools:function(a){var b=[{id:1,title:"願意"},{id:0,title:"不願意"}];if(a){for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]}else{if(0!=a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]}},getCarSources:function(a){var b=[{id:"1",title:"自購"},{id:"2",title:"捐贈"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getWheelChairCount:function(a){var b=[{id:"1",title:"1"},{id:"2",title:"2"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getGasTypes:function(a){var b=[{id:"EA2F7AA16C8711E895E642010A000602",title:SystemConfig.localizationer.getString("GASTYPE_TEXT_0001")},{id:"EA4527826C8711E895E642010A000602",title:SystemConfig.localizationer.getString("GASTYPE_TEXT_0002")},{id:"EA4BDAF16C8711E895E642010A000602",title:SystemConfig.localizationer.getString("GASTYPE_TEXT_0003")},{id:"EA5210D06C8711E895E642010A000602",title:SystemConfig.localizationer.getString("GASTYPE_TEXT_0004")}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getBarBrandModels:function(a){var b=[{id:"8F2D71E76C8911E895E642010A000602",title:"Volkswagen T4"},{id:"9A2C1C536C8911E895E642010A000602",title:"Volkswagen T5"},{id:"A03094D0702711E895E642010A000602",title:"Volkswagen T6"},{id:"A0327DA6702711E895E642010A000602",title:"Volkswagen Caddy"},{id:"A0346461702711E895E642010A000602",title:"FORD 旅行家"},{id:"A03A1D79702711E895E642010A000602",title:"MITSUBISHI 得利卡"},{id:"CE9362B48F4F11E895E642010A000602",title:"HYUNDAI STAREX"},{id:"8560C7B6948011E8A89D42010A000602",title:"其他"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getDriverLicense:function(a){var b=[{id:"2D501C086D5211E895E642010A000602",title:"職業大客車"},{id:"02ED3911C63711E8962942010A8C0FD5",title:"職業小客車"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getDriverInsurances:function(a){var b=[{id:"E91338D06D5211E895E642010A000602",title:"勞保一般"},{id:"BA0257716D5611E895E642010A000602",title:"勞保老年職保"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getDriverInsuranceList:function(a){if(!Array.isArray(a))return"";if(a){for(var b=[],c=0;c<a.length;c++)for(var d=0;d<result.length;d++)if(result[d].id==a[c]){b.push(result[d].title);break}return b.join(", ")}return""},getCarInsurances:function(a){var b=[{id:"2182E0106C9111E895E642010A000602",title:"強制險"},{id:"A3E6886B6C9111E895E642010A000602",title:"任意險"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getCarInsuranceList:function(a){if(!Array.isArray(a))return"";var b=[{id:"2182E0106C9111E895E642010A000602",title:"強制險"},{id:"A3E6886B6C9111E895E642010A000602",title:"任意險"}];if(a){for(var c=[],d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(b[e].id==a[d]){c.push(b[e].title);break}return c.join(", ")}return""},getCarDevices:function(a){var b=[{id:"5F951E1B6C8B11E895E642010A000602",title:"GPS",icon:"icon-gpsmachine"},{id:"7962285E6C8B11E895E642010A000602",title:"車機",icon:"icon-carmachine"},{id:"975AEC466C8B11E895E642010A000602",title:"攝影機",icon:"icon-camera"},{id:"EA8F00396C8B11E895E642010A000602",title:"滅火器",icon:"icon-fire-extinguisher"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getCarDeviceList:function(a){if(!Array.isArray(a))return"";var b=[{id:"5F951E1B6C8B11E895E642010A000602",title:"GPS",icon:"icon-gpsmachine"},{id:"7962285E6C8B11E895E642010A000602",title:"車機",icon:"icon-carmachine"},{id:"975AEC466C8B11E895E642010A000602",title:"攝影機",icon:"icon-camera"},{id:"EA8F00396C8B11E895E642010A000602",title:"滅火器",icon:"icon-fire-extinguisher"}];if(a){for(var c=[],d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(b[e].id==a[d]){c.push(b[e].title);break}return c.join(", ")}return""},getCarTops:function(a){var b=[{id:"standard",title:"正常"},{id:"high",title:"高頂"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getPlanLimits:function(a){var b=[{id:"22AF31157C3811E895E642010A000602",title:"身心障礙"},{id:"22C1C5847C3811E895E642010A000602",title:"65歲以上失能"},{id:"22C77A017C3811E895E642010A000602",title:"55-64歲以上原住民"},{id:"22CACED07C3811E895E642010A000602",title:"50歲以上失智"},{id:"E1882E3B989C11E8A89D42010A000602",title:"需協助的獨居或衰弱老人"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getFinances:function(a){var b=[{id:"B8FBAD406D8B11E895E642010A000602",title:"一般收入戶"},{id:"B90CCC846D8B11E895E642010A000602",title:"中低收入戶"},{id:"B9101ED26D8B11E895E642010A000602",title:"低收入戶"},{id:"8DDAF22661BD11E9A8BB42010A8C0FDE",title:"自費"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getContactRelationships:function(a){var b=[{id:"906D8872814A11E895E642010A000602",title:"親屬"},{id:"907BCBF5814A11E895E642010A000602",title:"朋友"},{id:"907F246B814A11E895E642010A000602",title:"照護專員"},{id:"90818798814A11E895E642010A000602",title:"其他"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getAuthItems:function(a){var b=[{id:"40A23A827E5A11E895E642010A000602",title:"居家服務"},{id:"40A585B97E5A11E895E642010A000602",title:"日間照顧"},{id:"40A7E53B7E5A11E895E642010A000602",title:"家庭托顧"},{id:"40AAC4317E5A11E895E642010A000602",title:"居家喘息服務"},{id:"40AD96C17E5A11E895E642010A000602",title:"機構喘息服務"},{id:"40AFF8AD7E5A11E895E642010A000602",
title:"居家護理"},{id:"40B25BD47E5A11E895E642010A000602",title:"居家職能治療"},{id:"40B5B6B17E5A11E895E642010A000602",title:"居家物理治療"},{id:"40B892687E5A11E895E642010A000602",title:"社區職能治療"},{id:"40BBE8667E5A11E895E642010A000602",title:"社區物理治療"},{id:"40BF35E97E5A11E895E642010A000602",title:"輔具"},{id:"40C28D787E5A11E895E642010A000602",title:"營養餐飲服務"},{id:"40C5665F7E5A11E895E642010A000602",title:"交通接送服務"},{id:"40C8C2B47E5A11E895E642010A000602",title:"機構服務"},{id:"40CBA0DA7E5A11E895E642010A000602",title:"密急性照護"},{id:"40CEF4407E5A11E895E642010A000602",title:"其他"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getAuthItemList:function(a){if(!Array.isArray(a))return"";var b=[{id:"40A23A827E5A11E895E642010A000602",title:"居家服務"},{id:"40A585B97E5A11E895E642010A000602",title:"日間照褲"},{id:"40A7E53B7E5A11E895E642010A000602",title:"家庭托顧"},{id:"40AAC4317E5A11E895E642010A000602",title:"居家喘息服務"},{id:"40AD96C17E5A11E895E642010A000602",title:"機構喘息服務"},{id:"40AFF8AD7E5A11E895E642010A000602",title:"居家護理"},{id:"40B25BD47E5A11E895E642010A000602",title:"居家職能治療"},{id:"40B5B6B17E5A11E895E642010A000602",title:"居家物理治療"},{id:"40B892687E5A11E895E642010A000602",title:"社區職能治療"},{id:"40BBE8667E5A11E895E642010A000602",title:"社區物理治療"},{id:"40BF35E97E5A11E895E642010A000602",title:"輔具"},{id:"40C28D787E5A11E895E642010A000602",title:"營養餐飲服務"},{id:"40C5665F7E5A11E895E642010A000602",title:"交通接送服務"},{id:"40C8C2B47E5A11E895E642010A000602",title:"機構服務"},{id:"40CBA0DA7E5A11E895E642010A000602",title:"密急性照護"},{id:"40CEF4407E5A11E895E642010A000602",title:"其他"}];if(a){for(var c=[],d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(b[e].id==a[d]){c.push(b[e].title);break}return c.join(", ")}return""},getSPStaffRoles:function(a){var b=[{id:"A969E6886C8311E895E642010A000602",title:"員工"},{id:"4793AED47CD511E895E642010A000602",title:"管理者"},{id:"47A06A617CD511E895E642010A000602",title:"系統管理員"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSPStaffStatus:function(a){var b=[{id:"1",title:"啟用中"},{id:"2",title:"停權"},{id:"3",title:"離職"},{id:"-1",title:"已刪除"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSPDriverStatus:function(a){var b=[{id:"1",title:"可派發"},{id:"2",title:"不可派發"},{id:"-1",title:"除役"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSPCarStatus:function(a){var b=[{id:"1",title:"可派發"},{id:"2",title:"不可派發"},{id:"-1",title:"除役"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSPCaseStatus:function(a){var b=[{id:"1",title:"有效"},{id:"2",title:"關閉"},{id:"-1",title:"過期"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSPBookingStatus:function(a){var b=[{id:"1",title:"新訂單"},{id:"-1",title:"客戶取消"},{id:"-2",title:"服務單位取消"},{id:"-3",title:"未執行"},{id:"1000",title:"計畫中"},{id:"1100",title:"已排班"},{id:"1200",title:"已出發"},{id:"1300",title:"已抵達客上地點"},{id:"1400",title:"客上"},{id:"1500",title:"空趟"},{id:"1700",title:"已送達"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSPShipmentStatus:function(a){var b=[{id:"1000",title:"新接送任務"},{id:"-1",title:"已取消"},{id:"-3",title:"未執行"},{id:"1100",title:"已推播"},{id:"1200",title:"已出發"},{id:"1300",title:"已抵達客上地點"},{id:"1400",title:"客上"},{id:"1500",title:"空趟"},{id:"1700",title:"客下"},{id:"2000",title:"完成任務"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSPPaidFeeTypes:function(a,b){var c=[{id:"1",title:"固定價格",checked:1==b},{id:"2",title:"里程計價",checked:2==b}];if(!a)return c;for(var d=0;d<c.length;d++)if(c[d].id==a)return c[d]},getSPTransportingBookingPayment:function(a){var b=[{id:"1",title:"政府補助"},{id:"2",title:"自費"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSPTransportingBookingPaymentCount:function(a){var b=[];return a<Core.config.subsidemax&&b.push({id:"1",title:"政府補助"}),b.push({id:"2",title:"自費"}),b},getReportCities:function(a){var b=[{id:"宜蘭縣",title:"宜蘭縣"},{id:"臺中市",title:"臺中市"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getPaymentTypes:function(a){var b=[{id:"1",title:"補助趟次"},{id:"2",title:"自費趟次"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getAdminMemberStatus:function(a){var b=[{id:"1",title:"啟用中"},{id:"2",title:"停權"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSupportCities:function(a){var b=[{id:"*",title:"全部縣市"},{id:"202",title:"宜蘭縣"},{id:"400",title:"臺中市"},{id:"950",title:"臺東縣"},{id:"970",title:"花蓮縣"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSupportCities2:function(a){var b=[{id:"202",title:"宜蘭縣"},{id:"400",title:"臺中市"},{id:"950",title:"臺東縣"},{id:"970",title:"花蓮縣"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSupportCities3:function(a){var b=[{id:"宜蘭縣",title:"宜蘭縣"},{id:"臺中市",title:"臺中市"},{id:"花蓮縣",title:"花蓮縣"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]},getSupportCities4:function(a){var b=[{id:"基隆市",title:"基隆市"},{id:"宜蘭縣",title:"宜蘭縣"},{id:"臺北市",title:"臺北市"},{id:"新北市",title:"新北市"},{id:"桃園市",title:"桃園市"},{id:"新竹縣",title:"新竹縣"},{id:"苗栗縣",title:"苗栗縣"},{id:"南投縣",title:"南投縣"},{id:"臺中市",title:"臺中市"},{id:"彰化縣",title:"彰化縣"},{id:"雲林縣",title:"雲林縣"},{id:"嘉義縣",title:"嘉義縣"},{id:"嘉義市",title:"嘉義市"},{id:"台南市",title:"台南市"},{id:"屏東縣",title:"屏東縣"},{id:"台東縣",title:"台東縣"},{id:"花蓮縣",title:"花蓮縣"}];if(!a)return b;for(var c=0;c<b.length;c++)if(b[c].id==a)return b[c]}},Core.Communication={},Core.Communication.CommnicateAgent=function(a,b,c){function d(a,b,c,d){var g=c.method?c.method:"POST",h=c.timeout?c.timeout:6e4;$.ajax({type:g,contentType:"application/json;charset=UTF-8",timeout:h,dataType:"json",url:a,data:b,headers:{authorization:d?SystemConfig.UserProfile.getToken():""},success:function(a,b,c){var d=a;try{if(f&&d&&(f.Stop(),f=void 0),d.status)switch(d.status.toString()){case"401":var g=new Core.Control.Dialogs.MessageDialog;g.ShowDialog(SystemConfig.localizationer.getString("ERRORCODE_LOGIN_"+d.status.toString()),"error",[{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}]),g.addEventListener("OnOK",function(){switch(SystemConfig.UserProfile.getRole()){case Core.UserProfile.RoleTypes.spadmin:case Core.UserProfile.RoleTypes.spmanager:case Core.UserProfile.RoleTypes.spop:window.open("splogin.html","_blank");break;case Core.UserProfile.RoleTypes.customer:window.open("cuslogin.html","_blank");break;case Core.UserProfile.RoleTypes.driver:window.open("driverlogin.html","_blank")}e.execute("OnError",d)});break;case"500":Core.showError("DB Lost - My Friend !");break;case"200":case"1":e.execute("OnData",d);break;default:e.execute("OnError",d)}else e.execute("OnError",d)}catch(h){e.execute("OnError",h),1!==Core.release&&console.error(h.message)}},error:function(a,b,c){switch(f&&(f.Stop(),f=void 0),a.status){case 401:var d=new Core.Control.Dialogs.MessageDialog;d.ShowDialog(SystemConfig.localizationer.getString("ERRORCODE_LOGIN_401"),"error",[{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}]),d.addEventListener("OnOK",function(){window.location.href="index.html"});break;default:e.execute("OnError",{status:a.status})}},complete:function(){f&&(f.Stop(),f=void 0),e.execute("OnComplete","")}})}var e=this;Core.Communication.CommnicateAgent.superclass.constructor.call(this),e.initCtlAttr({useProgress:a?a===!0?!0:a:!1,timeout:b||Core.release?1e4:3e4,nologout:c||!1,maxRetry:"local"===SystemConfig.sitemarker?10:5});var f;this.DeleteData=function(a,b){if(e.getCtlAttr("useProgress")){var c;e.getCtlAttr("useProgress")!==!0&&(c=e.getCtlAttr("useProgress")),f=new Core.Control.Spinners.Spinner,f.ShowFullSpinner()}try{d(a.url+b,{},{method:"DELETE"},a.token)}catch(g){f&&(f.Stop(),f=void 0),e.execute("OnError",void 0)}},this.GetData=function(a,b){if(e.getCtlAttr("useProgress")){var c;e.getCtlAttr("useProgress")!==!0&&(c=e.getCtlAttr("useProgress")),f=new Core.Control.Spinners.Spinner,f.ShowFullSpinner()}try{var g="";for(var h in b)g+=(g.length>0?"&":"")+h+"="+b[h];d(a.url,g,{method:"GET"},a.token)}catch(i){f&&(f.Stop(),f=void 0),e.execute("OnError",void 0)}},this.GetData2=function(a,b){if(e.getCtlAttr("useProgress")){var c;e.getCtlAttr("useProgress")!==!0&&(c=e.getCtlAttr("useProgress")),f=new Core.Control.Spinners.Spinner,f.ShowFullSpinner()}try{d(a.url+b,{},{method:"GET"},a.token)}catch(g){f&&(f.Stop(),f=void 0),e.execute("OnError",void 0)}},this.GetData3=function(a,b){if(e.getCtlAttr("useProgress")){var c;e.getCtlAttr("useProgress")!==!0&&(c=e.getCtlAttr("useProgress")),f=new Core.Control.Spinners.Spinner,f.ShowFullSpinner()}try{d(a.url+b,"",{method:"GET"},a.token)}catch(g){f&&(f.Stop(),f=void 0),e.execute("OnError",void 0)}},this.PostData=function(a,b,c){var g=c||{};if(g.method="POST",e.getCtlAttr("useProgress")){var h;e.getCtlAttr("useProgress")!==!0&&(h=e.getCtlAttr("useProgress")),f=new Core.Control.Spinners.Spinner,f.ShowFullSpinner()}try{d(a.url,JSON.stringify(b),g,a.token)}catch(i){f&&(f.Stop(),f=void 0),e.execute("OnError",void 0)}},this.PostData2=function(a,b,c){var g=c||{};if(g.method="POST",e.getCtlAttr("useProgress")){var h;e.getCtlAttr("useProgress")!==!0&&(h=e.getCtlAttr("useProgress")),f=new Core.Control.Spinners.Spinner,f.ShowFullSpinner()}try{d(a.url+b,"",g,a.token)}catch(i){f&&(f.Stop(),f=void 0),e.execute("OnError",void 0)}}},Core.extend(Core.Communication.CommnicateAgent,Core.BaseControl,{OnData:"",OnError:"",OnComplete:""}),Core.RequestUrl={serverurl:"dkmgmtapi/",siteurl:"",countrycode:void 0,init:function(){Core.RequestUrl.parseApiPath()&&(Core.RequestUrl.serverurl="http://localhost:8080/dkmgmtapi/");for(var a in Core.RequestUrl.urls)Core.RequestUrl.urls[a].url=Core.RequestUrl.serverurl+Core.RequestUrl.urls[a].url;$.get("https://ipinfo.io",function(a){},"jsonp").done(function(a){Core.RequestUrl.countrycode=a.country}),Core.RequestUrl.siteurl="https"==document.location.protocol?"https://":"http://",document.location.host.indexOf("qa")>-1?Core.RequestUrl.siteurl+="qamgmt.donkeymove.com/":document.location.host.indexOf("dk")>-1?Core.RequestUrl.siteurl+="dkmgmt.donkeymove.com/":"www.donkeymove.com"==document.location.host||"mgmt.donkeymove.com"==document.location.host?Core.RequestUrl.siteurl+="mgmt.donkeymove.com/":Core.RequestUrl.siteurl=""},parseApiPath:function(){var a=window.location.hostname.split(".");return"localhost"===window.location.hostname?!0:4===a.length&&192===window.parseInt(a[0])&&(a.pop(),a=a.join("."),"192.168.0"===a)?!0:!1},getCountryCode:function(){return Core.RequestUrl.countrycode},getUrl:function(a){return Core.RequestUrl.urls[a]},urls:{spcheckaccount:{url:"staff/account/check",method:"POST",token:!1},spsignin:{url:"staff/account/login",method:"POST",token:!1},spsignout:{url:"staff/account/logout",method:"POST",token:!0},spresetpwdemail:{url:"staff/password/reset",method:"POST",token:!1},spcheckverify:{url:"staff/verifycode/check",method:"POST",token:!1},spfgchpws:{url:"staff/reset/change",method:"POST",token:!1},spdashboarddata:{url:"dashboard/detail/list",method:"POST",token:!0},spdashboardachievedata:{url:"dashboard/achieve/list",method:"POST",token:!0},spprofile:{url:"serviceprovider/",methoid:"GET",token:!0},spprofileupdate:{url:"serviceprovider/update",method:"POST",token:!0},spbookingreport:{url:"staff/report/booking",method:"POST",token:!0},spshipmentreport:{url:"staff/report/shipment",method:"POST",token:!0},spcarreport:{url:"staff/report/car/district",method:"POST",token:!0},spdriverreport:{url:"staff/report/driver/district",method:"POST",token:!0},spbookingdistrictreport:{url:"staff/report/booking/district",method:"POST",token:!0},spdownloadhealthwelfare:{url:"download/serviceprovider/healthwelfarev5",method:"POST",token:!0},spdownloadbookingdetail:{url:"download/serviceprovider/bookingdetailv1",method:"POST",token:!0},spdownloadfile:{url:"download/serviceprovider/excel",method:"GET",token:!0},spdownloadbookingjobticket:{url:"download/serviceprovider/bookingjobticket",method:"POST",token:!0},spdownloadshipmentjobticket:{url:"download/serviceprovider/shipmentjobticket",method:"POST",token:!0},spdownloaddaytshipmentjobticket:{url:"download/serviceprovider/day/shipmentjobticket",method:"POST",token:!0},spdownloadpdffile:{url:"download/serviceprovider/pdf",method:"GET",token:!0},spcomconfigprofile:{url:"comconfig/",method:"GET",token:!0},spcomconfigfeelist:{url:"comconfig/fee/list",method:"GET",token:!0},spcomconfigfeenew:{url:"comconfig/fee/",method:"POST",token:!0},spcomconfigfeeprofile:{url:"comconfig/fee/",method:"GET",token:!0},spcomconfigfeeupdate:{url:"comconfig/fee/update",method:"POST",token:!0},spcomconfigfeedel:{url:"comconfig/fee/",method:"DELETE",token:!0},spstaffnew:{url:"staff/account",method:"POST",token:!0},spstafflist:{url:"staff/account/list",method:"POST",token:!0},spstaffprofile:{url:"staff/account/",method:"GET",token:!0},spstaffupdate:{url:"staff/account/update",method:"POST",token:!0},spstaffupdatemy:{url:"staff/account/updatemy",method:"POST",token:!0},spstaffdel:{url:"staff/account/",method:"DELETE",token:!0},spchpws:{url:"staff/password/change",method:"POST",token:!0},spcasenew:{url:"case",method:"POST",token:!0},spcaselist:{url:"case/list",method:"POST",token:!0},spcaseprofile:{url:"case/",method:"GET",token:!0},spcaseupdate:{url:"case/update",method:"POST",token:!0},spcaseidprofile:{url:"case/id/",method:"GET",token:!0},spcaseidupdate:{url:"case/id/update",method:"POST",token:!0},spcaseprofile2:{url:"case/bookingrecord/",method:"GET",token:!0},spcasedel:{url:"case/",method:"DELETE",token:!0},spcasecommentlist:{url:"case//extra/comment/list",method:"POST",token:!0},spcasecommentnew:{url:"case//extra/comment",method:"POST",token:!0},spgetcusdispatchcount:{url:"case/transporting/free_dispatch/",method:"GET",token:!0},sptransportingbookingnew:{url:"transporting/booking",method:"POST",token:!0},sptransportingbookinglist:{url:"transporting/booking/list",method:"POST",token:!0},sptransportingbookingprofile:{url:"transporting/booking/",method:"GET",token:!0},sptransportingbookingprofilecount:{url:"transporting/booking/count",method:"GET",token:!0},sptransportingbookingupdate:{url:"transporting/booking/update",method:"POST",token:!0},sptransportingbookingdel:{url:"transporting/booking/",method:"DELETE",token:!0},sptransportingbookingsearch:{url:"transporting/booking/search",method:"POST",token:!0},spget_auto_bookingid:{url:"transporting/booking/auto/bookingid",method:"POST",token:!0},sptransportingbookingprofilebyshcode:{url:"transporting/booking/shcode/",method:"GET",token:!0},sptransportingbookingroute:{url:"transporting/booking/route",method:"POST",token:!0},spgettransportingcount:{url:"case/transporting/query",method:"POST",token:!0},spfleetnew:{url:"fleet",method:"POST",token:!0},spfleetlist:{url:"fleet/list",method:"POST",token:!0},spfleetdispatchlist:{url:"fleet/dispatchlist",method:"GET",token:!0},spfleetprofile:{url:"fleet/",method:"GET",token:!0},spfleetsimpleprofile:{url:"fleet/simple/",method:"GET",token:!0},spfleetupdate:{url:"fleet/update",method:"POST",token:!0},spfleetdel:{url:"fleet/",method:"DELETE",token:!0},spcarlist:{url:"fleet/car/list",method:"POST",token:!0},spcarnew:{url:"fleet/car",method:"POST",token:!0},spcardel:{url:"fleet/car/",method:"DELETE",token:!0},spcarprofile:{url:"fleet/car/",method:"GET",token:!0},spcarupdate:{url:"fleet/car/update",method:"POST",token:!0},spcarposition:{url:"fleet/car/coordination/list",method:"POST",token:!0},spdriverlist:{url:"fleet/driver/list",method:"POST",token:!0},spdrivernew:{url:"fleet/driver",method:"POST",token:!0},spdriverdel:{url:"fleet/driver/",method:"DELETE",token:!0},spdriverchpws:{url:"fleet/driver/password/change",method:"POST",token:!0},spdriverprofile:{url:"fleet/driver/",method:"GET",token:!0},spdriverupdate:{url:"fleet/driver/update",method:"POST",token:!0},spshipmentnew:{url:"shipment",method:"POST",token:!0},spshipmentprofile:{url:"shipment/",method:"GET",token:!0},spshipmentlist:{url:"shipment/list",method:"POST",token:!0},spshipmentdispatchdetail:{url:"shipment/dispatch/",method:"GET",token:!0},spshipmentsimplelist:{url:"shipment/simplelist",method:"POST",token:!0},spshipmentpush:{url:"shipment/push",method:"POST",token:!0},spshipmentunpush:{url:"shipment/cancel/pushAll",method:"POST",token:!0},spshipmentdel:{url:"shipment/",method:"DELETE",token:!0},spshipmentdetail:{url:"shipment/info/",method:"GET",token:!0},spshipmentforcedel:{url:"shipment/force/",method:"DELETE",token:!0},spshipmentguid:{url:"shipment/guid/",method:"GET",token:!0},sptransportingbookingguid:{url:"transporting/booking/guid/",method:"GET",token:!0},sptransportingbookinghistory:{url:"transporting/booking/history/",method:"GET",token:!0},spshipmenthistory:{url:"shipment/history/",method:"GET",token:!0},get_auto_hospitaldata:{url:"autocomplete/getHospital",method:"GET",token:!1},get_auto_caserecord:{url:"autocomplete/getCaseRecord",method:"POST",token:!0},get_auto_staffid:{url:"autocomplete/getStaffID",method:"POST",token:!0},get_auto_staffcmpno:{url:"autocomplete/getStaffCmpNo",method:"POST",token:!0},get_auto_staffname:{url:"autocomplete/getStaffName",method:"POST",token:!0},get_auto_staffnaid:{url:"autocomplete/getStaffNAID",method:"POST",token:!0},get_auto_drivername:{url:"autocomplete/getDriverName",method:"POST",token:!0},get_auto_drivercmpno:{url:"autocomplete/getDriverCmpNo",method:"POST",token:!0},get_auto_driverlicenseno:{url:"autocomplete/getDriverLicenseNo",method:"POST",token:!0},get_auto_drivernaid:{url:"autocomplete/getDriverNAID",method:"POST",token:!0},get_auto_driverserviceno:{url:"autocomplete/getDriverServiceNo",method:"POST",token:!0},get_auto_carplateno:{url:"autocomplete/getCarPlateNo",method:"POST",token:!0},get_auto_fleetcar:{url:"autocomplete/fleet/getCar",method:"POST",token:!0},get_auto_fleetdriver:{url:"autocomplete/fleet/getDriver",method:"POST",token:!0},get_auto_caseid:{url:"autocomplete/case/getCaseID",method:"POST",token:!0},get_auto_casename:{url:"autocomplete/case/getCaseName",method:"POST",token:!0},get_auto_casenaid:{url:"autocomplete/case/getCaseNAID",method:"POST",token:!0},get_auto_bookingid:{url:"autocomplete/transporting/booking/getBookingID",method:"POST",token:!0},get_auto_bookingshcode:{url:"autocomplete/transporting/booking/getBookingShortCode",method:"POST",token:!0},carchecklist:{url:"carcheck/list",method:"POST",token:!0},carcheckprofile:{url:"carcheck/record/",method:"GET",token:!0},check_staffemail:{url:"staff/account/check/email",method:"POST",token:!0},check_staffnaid:{url:"staff/account/check/naid",method:"POST",token:!0},check_staffcmpno:{url:"staff/account/check/cmpno",method:"POST",token:!0},check_driveremail:{url:"fleet/driver/check/email",method:"POST",token:!0},check_drivernaid:{url:"fleet/driver/check/naid",method:"POST",token:!0},check_drivercmpno:{url:"fleet/driver/check/cmpno",method:"POST",token:!0},check_driverlicenseno:{url:"fleet/driver/check/licenseno",method:"POST",token:!0},check_driverserviceno:{url:"fleet/driver/check/serviceno",method:"POST",token:!0},check_casenaid:{url:"case/check/naid",method:"POST",token:!0},check_casecaseno:{url:"case/check/caseno",method:"POST",token:!0},cuscheckaccount:{url:"customer/account/check",method:"POST",token:!1},cussignin:{url:"customer/account/login",method:"POST",token:!1},cussignout:{url:"customer/account/logout",method:"POST",token:!0},cusresetpwdemail:{url:"customer/account/login",method:"POST",token:!1},cusregister:{url:"customer/account/register",method:"POST",token:!0},cusprofile:{url:"customer/account/",method:"GET",token:!0},cusupdate:{url:"customer/account/update",method:"POST",token:!0},cuschpws:{url:"customer/account/password/change",method:"POST",token:!0},cusresetpwssms:{url:"customer/password/reset",method:"POST",token:!1},cuscheckverify:{url:"customer/verifycode/check",method:"POST",token:!1},cusfgchpws:{url:"customer/reset/change",method:"POST",token:!1},getsplist:{url:"customer/splist",method:"GET",token:!0},cuscaseprofile:{url:"customer/case/",method:"GET",token:!0},custransportingbookingnew:{url:"customer/transporting/booking",method:"POST",token:!0},custransportingbookinglist:{url:"customer/transporting/booking/list",method:"POST",token:!0},custransportingbookingprofile:{url:"customer/transporting/booking/",method:"GET",token:!0},custransportingbookingprofilebyshcode:{url:"customer/transporting/booking/shcode/",method:"GET",token:!0},custransportingbookingupdate:{url:"customer/transporting/booking/update",method:"POST",token:!0},custransportingbookingdel:{url:"customer/transporting/booking/",method:"DELETE",token:!0},custransportingbookingactivelist:{url:"customer/transporting/booking/activelist",method:"POST",token:!0},transportingbookingprofilebyshcode:{url:"customer/transporting/booking/viewshcode/",method:"GET",token:!1},get_auto_cusbookingid:{url:"customer/transporting/booking/getBookingID",method:"POST",token:!0},get_auto_cusbookingshcode:{url:"customer/transporting/booking/getBookingShortCode",method:"POST",token:!0},cusgettransportingcount:{url:"customer/transporting/free_dispatch",method:"GET",token:!0},cusgetalltransportingcount:{url:"customer/transporting/query",method:"POST",token:!0},serviceproviderprofile:{url:"serviceprovider/customer/",method:"GET",token:!0},custransportingbookingguid:{url:"customer/transporting/booking/guid/",method:"GET",token:!0},custransportingbookinghistory:{url:"customer/transporting/booking/history/",method:"GET",token:!0},check_customernaid:{url:"customer/account/check/naid",method:"POST",token:!1},globalreport_bookingcitydistrict:{url:"globalreport/booking/citydistrict",method:"POST",token:!1},globalreport_bookingcitysp:{url:"globalreport/booking/cityserviceprovider",method:"POST",token:!1},globalreport_bookingtwcities:{url:"globalreport/booking/city",method:"POST",token:!1},admincheckaccount:{url:"admin/account/check",method:"POST",token:!1},adminsignin:{url:"admin/account/login",method:"POST",token:!1},adminsignout:{url:"admin/account/logout",method:"POST",token:!0},adminchpws:{url:"admin/password/change",method:"POST",token:!0},adminresetpwdemail:{url:"admin/password/reset",method:"POST",token:!1},admincheckverify:{url:"admin/verifycode/check",method:"POST",token:!1},adminfgchpws:{url:"admin/reset/change",method:"POST",token:!1},adminstaffmyprofile:{url:"admin/account/",method:"GET",token:!0},adminstaffupdatemy:{url:"admin/account/update",method:"POST",token:!0},admintransportingbookinglist:{url:"admin/booking/list",method:"POST",token:!0},adminget_auto_companyid:{url:"admin/auto/spid",method:"POST",token:!0},admincaseprofile:{url:"case/admin/",method:"GET",token:!0},admingettransportingcount:{url:"case/admin/transporting/query",method:"POST",token:!0},admintransportingbookingguid:{url:"transporting/admin/booking/guid/",method:"GET",token:!0},admintransportingbookinghistory:{url:"transporting/admin/booking/history/",method:"GET",token:!0},admintransportingbookingprofile:{url:"transporting/admin/booking/",method:"GET",token:!0},adminshipmentguid:{url:"shipment/admin/guid/",method:"GET",token:!0},adminshipmenthistory:{url:"shipment/admin/history/",method:"GET",token:!0},adminshipmentdetail:{url:"shipment/info/",method:"GET",token:!0},adminget_auto_caseid:{url:"autocomplete/admin/case/getCaseID",method:"POST",token:!0},adminget_auto_casename:{url:"autocomplete/admin/case/getCaseName",method:"POST",token:!0},adminget_auto_casenaid:{url:"autocomplete/admin/case/getCaseNAID",method:"POST",token:!0},adminget_auto_bookingid:{url:"autocomplete/admin/transporting/booking/getBookingID",method:"POST",token:!0},adminget_auto_bookingshcode:{url:"autocomplete/admin/transporting/booking/getBookingShortCode",method:"POST",token:!0},adminfleetlist:{url:"fleet/admin/list",method:"POST",token:!0},admincarlist:{url:"fleet/car/admin/list",method:"POST",token:!0},adminget_auto_carplateno:{url:"autocomplete/admin/getCarPlateNo",method:"POST",token:!0},admincarprofile:{url:"fleet/car/admin/",method:"GET",token:!0},admindriverlist:{url:"fleet/driver/admin/list",method:"POST",token:!0},adminget_auto_drivername:{url:"autocomplete/admin/getDriverName",method:"POST",token:!0},adminget_auto_drivercmpno:{url:"autocomplete/admin/getDriverCmpNo",method:"POST",token:!0},adminget_auto_driverlicenseno:{url:"autocomplete/admin/getDriverLicenseNo",method:"POST",token:!0},adminget_auto_drivernaid:{url:"autocomplete/admin/getDriverNAID",method:"POST",token:!0},adminget_auto_driverserviceno:{url:"autocomplete/admin/getDriverServiceNo",method:"POST",token:!0},admindriverprofile:{url:"fleet/driver/admin/",method:"GET",token:!0},adminstafflist:{url:"staff/admin/account/list",method:"POST",token:!0},adminstaffprofile:{url:"staff/admin/account/",method:"GET",token:!0},adminsplist:{url:"serviceprovider/admin/list",method:"POST",token:!0},adminspprofile:{url:"admin/servicesprovider/",method:"GET",token:!0},adminspprofile2:{url:"serviceprovider/admin/",method:"GET",token:!0},adminaddsp:{url:"serviceprovider/admin",method:"POST",token:!0},adminupdatesp:{url:"serviceprovider/admin/update",method:"POST",token:!0},admindelsp:{url:"serviceprovider/admin/",method:"DELETE",token:!0},admindelforcesp:{url:"serviceprovider/admin/force/",method:"DELETE",token:!0},admincaselist:{url:"case/admin/splist",method:"POST",token:!0},adminregcaselist:{url:"case/admin/customerlist",method:"POST",token:!0},adminregcaseprofile:{url:"customer/admin/account/",method:"GET",token:!0},adminfeelist:{url:"fee/admin/list",method:"POST",token:!0},adminfeeupdate:{url:"fee/admin/update",method:"POST",token:!0},adminmembernew:{url:"admin/account",method:"POST",token:!0},adminmemberlist:{url:"admin/account/list",method:"POST",token:!0},adminmemberprofile:{url:"admin/account/",method:"GET",token:!0},adminmemberupdate:{url:"admin/account/update",method:"POST",token:!0},adminmemberdel:{url:"admin/account/",method:"DELETE",token:!0},adminmemberchgpws:{url:"admin/password/change",method:"POST",token:!0},admindashboarddata:{url:"dashboard/admin/detail/list",method:"POST",token:!0},admindashboardachievedata:{url:"dashboard/admin/achieve/list",method:"POST",token:!0},adminhospitallist:{url:"hospital/admin/list",method:"POST",token:!0},adminaddhospital:{url:"hospital/admin",method:"POST",token:!0},adminhospitalprofile:{url:"hospital/admin/",method:"GET",token:!0},adminupdatehospital:{url:"hospital/admin/update",method:"POST",token:!0},adminadelhospital:{url:"hospital/admin/",method:"DELETE",token:!0},adminshipmentlist:{url:"shipment/admin/list",method:"POST",token:!0},adminshipmentdetail:{url:"shipment/admin/info/",method:"GET",token:!0}}},Core.RequestUrl.init(),Core.UserProfile={},Core.UserProfile.sessioncats={customer:1e3,sp:1100,driver:1200,sys:2e3},Core.UserProfile.RoleTypes={customer:"59A85F197CDC11E895E642010A000602",spadmin:"47A06A617CD511E895E642010A000602",spmanager:"4793AED47CD511E895E642010A000602",spop:"A969E6886C8311E895E642010A000602",driver:"AA97CB957CDC11E895E642010A000602",sys:"5FF25C717CDC11E895E642010A000602",none:"xxxxxxxx"},Core.UserProfile.userProfile=function(a,b,c){function d(a){if("update"==a.action&&a.target.toUpperCase()==j.guid.toUpperCase()){var b=new Core.Communication.CommnicateAgent(!0);switch(b.addEventListener("OnData",function(a){if(a&&200==a.status)switch(g){case Core.UserProfile.sessioncats.customer:f.CusUpdateProfile(a.data);break;case Core.UserProfile.sessioncats.sys:f.AdminUpdateProfile(a.data);break;default:f.LoginUpdateProfile(a.data)}}),b.addEventListener("OnError",function(a){}),g){case Core.UserProfile.sessioncats.customer:b.GetData2(Core.RequestUrl.getUrl("cusprofile"),j.guid);break;case Core.UserProfile.sessioncats.sys:b.GetData2(Core.RequestUrl.getUrl("adminprofile"),j.guid);break;default:b.GetData2(Core.RequestUrl.getUrl("spstaffprofile"),j.guid)}}}function e(a,b){if("session"==l.type){var c=JSON.parse(window.sessionStorage[h]);c.hasOwnProperty(a)&&(c[a]=b,window.sessionStorage[h]=JSON.stringify(c))}else{var d=Core.Utility.Utility.CookieHelper.getCookie(h);if(d){var c=JSON.parse(d);c.hasOwnProperty(a)&&(c[a]=b,Core.Utility.Utility.CookieHelper.createCookie(h,JSON.stringify(c),l.expired,"/"))}}}var f=this;Core.UserProfile.userProfile.superclass.constructor.call(this);var g=b,h="dkcus";switch(g){case Core.UserProfile.sessioncats.customer:break;case Core.UserProfile.sessioncats.sp:h="dksp";break;case Core.UserProfile.sessioncats.driver:h="dkdriver";break;case Core.UserProfile.sessioncats.sys:h="dksys";break;case Core.UserProfile.sessioncats.none:h="dknone"}var i=!1,j={config:{}},k={app_id:"",key:"",secret:"",system_channel:""},l={type:"cookie",expired:1},m=void 0;this.AdminLogin=function(a){f.AdminUpdate(a)},this.AdminUpdate=function(a){j.pic=a.picture,j.email=a.email,j.first_name=a.name.first,j.last_name=a.name.last,j.authorization=a.authorization,j.langid=a.langid,j.push_id=a.push_id,j.guid=a.guid,j.status=a.status,j.roleid=a.role_id,i=!0,"session"==l.type?window.sessionStorage[h]=JSON.stringify(j):Core.Utility.Utility.CookieHelper.createCookie(h,j,l.expired,"/")},this.AdminUpdateProfile=function(a){j.pic=a.picture,j.email=a.email,j.first_name=a.name.first,j.last_name=a.name.last,"session"==l.type?window.sessionStorage[h]=JSON.stringify(j):Core.Utility.Utility.CookieHelper.createCookie(h,j,l.expired,"/"),f.execute("OnUpdate","")},this.CusLogin=function(a){f.CusUpdate(a)},this.CusUpdate=function(a){j.pic=a.picture,j.email=a.email,j.first_name=a.name.first,j.last_name=a.name.last,j.authorization=a.authorization,j.langid=a.langid,j.push_id=a.push_id,j.guid=a.guid,j.status=a.status,j.roleid="59A85F197CDC11E895E642010A000602",i=!0,"session"==l.type?window.sessionStorage[h]=JSON.stringify(j):Core.Utility.Utility.CookieHelper.createCookie(h,j,l.expired,"/")},this.CusUpdateProfile=function(a){j.pic=a.picture,j.email=a.email,j.first_name=a.name.first,j.last_name=a.name.last,"session"==l.type?window.sessionStorage[h]=JSON.stringify(j):Core.Utility.Utility.CookieHelper.createCookie(h,j,l.expired,"/"),f.execute("OnUpdate","")},this.Login=function(a){f.LoginUpdate(a)},this.LoginUpdate=function(a){j.pic=a.pic,j.company_guid=a.company_guid,j.email=a.email,j.first_name=a.first_name,j.last_name=a.last_name,j.authorization=a.authorization,j.langid=a.langid,j.push_id=a.push_id,j.roleid=a.role_id,j.staff_id=a.staff_id,j.guid=a.guid,j.status=a.status,i=!0,"session"==l.type?window.sessionStorage[h]=JSON.stringify(j):Core.Utility.Utility.CookieHelper.createCookie(h,j,l.expired,"/")},this.LoginUpdateProfile=function(a){j.pic=a.picture,j.email=a.email,j.first_name=a.name.first,j.last_name=a.name.last,j.status=a.status,"session"==l.type?window.sessionStorage[h]=JSON.stringify(j):Core.Utility.Utility.CookieHelper.createCookie(h,j,l.expired,"/"),f.execute("OnUpdate","")},this.Logout=function(){m&&(m.Deattach(),delete m,m=void 0),j={},i=!1,f.ClearSessions()},this.LoadFromSession=function(a){if(i=!1,"session"==l.type){if(void 0!=window.sessionStorage[h])try{var b=JSON.parse(window.sessionStorage[h]);b.authorization&&(j=b,i=!0,SystemConfig.pusher.RegisterEvent("UserProfile_System",j.guid,d),m=new Core.DownloadAgent,m.Attach($("body"),j.guid))}catch(c){}}else try{var e=Core.Utility.Utility.CookieHelper.getCookie(h);e&&e.authorization&&(j=e,i=!0,SystemConfig.pusher.RegisterEvent("UserProfile_System",j.guid,d),m=new Core.DownloadAgent,m.Attach($("body"),j.guid))}catch(c){}return i},this.GetSessionValue=function(a){if(a)if("session"==l.type)result=window.sessionStorage.getItem(a);else{var b=Core.Utility.Utility.CookieHelper.getCookie(h);if(b){var c=JSON.parse(b);return c[a]}}return""},this.ClearSessions=function(){"session"==l.type?window.sessionStorage.removeItem(h):Core.Utility.Utility.CookieHelper.deleteCookie(h)},this.GetPushInfo=function(){return k},this.getGUID=function(){return j&&j.guid?j.guid:void 0},this.getAuthorization=function(){return j.authorization},this.getToken=function(){return j&&j.guid&&j.authorization?j.guid+"_"+j.authorization:""},this.getCompnayGUID=function(){return j&&j.company_guid?j.company_guid:void 0},this.getFirstName=function(){return j.first_name},this.getLastName=function(){return j.last_name;
},this.getFullName=function(){return SystemConfig.localizationer.showName({first:j.first_name,last:j.last_name})},this.getLangID=function(){return j.langid?j.langid:"zh-tw"},this.setLangID=function(a){j.langid=a,e("langid",a)},this.getThumb=function(){return j.pic+"?k="+Core.getGUID()},this.setThumb=function(a){j.pic=a},this.getCompanyInfo=function(){return{guid:j.company_guid}},this.getRole=function(){return j.roleid},this.getStaffID=function(){return j.staff_id},this.getStatus=function(){return j.status},this.IsLogin=function(){return i},this.getProfile=function(){return j},this.setProfile=function(a){j=$.extend(j,a)},this.IsSessionSP=function(){switch(j.role_id){case Core.UserProfile.RoleTypes.spadmin:case Core.UserProfile.RoleTypes.spmanager:case Core.UserProfile.RoleTypes.spop:return!0;default:return!1}},this.IsSessionDriver=function(){return j.role_id==Core.UserProfile.RoleTypes.driver?!0:!1},this.IsSessionCustomer=function(){return j.role_type==Core.UserProfile.RoleTypes.customer?!0:!1},this.IsSessionSys=function(){return j.role_id==Core.UserProfile.RoleTypes.sys?!0:!1},this.CreateDownload=function(a){m&&m.CreateDownload(a)},a&&(f.LoadFromSession()||c||(window.location.href="index.html"))},Core.extend(Core.UserProfile.userProfile,Core.iObject,{OnUpdate:""}),Core.Utility.Utility={JSONHelper:{AssignValue:function(a,b,c){c?$.extend(!0,a,b):$.each(a,function(c,d){b.hasOwnProperty(c)&&(a[c]=b[c])})},EmptyAssign:function(a){return $.each(a,function(b,c){void 0===c&&(a[b]="")}),a},WalkThrew:function(a,b){for(var c=b.split(".");c.length&&(a=a[c.shift()]););return a},GetKey:function(a,b){for(var c in b)if(b[c]==a)return c}},TooltipHelper:{GenerateToolTip:function(a){for(var b=$("<table/>").css({width:"auto",height:"auto"}),c=0;c<a.length;c++){var d=$("<tr/>").appendTo(b);$("<td/>").appendTo(d).append($("<div/>").text(a[c].title)),$("<td/>").appendTo(d).append($("<div/>").addClass("common_tooptipul_text").text(a[c].text))}return b}},FileHelper:{GetFileExtension:function(a){return a.split(".").pop().toLowerCase()}},MaskHelper:{GenerateTelMask:function(a){for(var b="t?",c=0;a-1>c;c++)b+="t";return b},GenerateFaxMask:function(a){for(var b="t?",c=0;a-1>c;c++)b+="t";return b},GenerateNumberMask:function(a,b){if(b){for(var c="w?",d=0;a-1>d;d++)c+="w";return c}for(var c="9?",d=0;a-1>d;d++)c+="9";return c},GenerateMoneyMask:function(a,b){if(b){for(var c="w?",d=0;a-1>d;d++)c+="w";return c}for(var c="z?",d=0;a-1>d;d++)c+="z";return c},GenerateRateMask:function(a){for(var b="u?",c=0;a-1>c;c++)b+="u";return b},GenerateZipCodeMask:function(a){var b="z?";a||(a=6);for(var c=0;a-1>c;c++)b+="9";return b},GenerateInvoiceMask:function(a){var b="i?";a||(a=15);for(var c=0;a-1>c;c++)b+="i";return b},GenerateAlphaNumberMask:function(a){var b="c?";a||(a=15);for(var c=0;a-1>c;c++)b+="c";return b},GenerateNAIDMask:function(a){return"a?ttttttttt"},GenerateTAXIDMask:function(a){return"9?9999999"}},ArrayHelper:{CreateNumberArray:function(a,b,c){for(var d=[],e=a;b>e;e++)c?d.push({id:e,title:e}):d.push(e);return d},ObjArrDiff:function(a,b){var c,d=[],e=[],f=[],g=!1;return $.extend(e,[],a),$.extend(f,[],b),e.length<=f.length&&(c=e,e=f,f=c),$.each(e,function(a,b){g=!1,$.each(f,function(a,c){JSON.stringify(b)==JSON.stringify(c)&&(g=!0)}),g||d.push(b)}),d},CreateDecimalArray:function(a,b,c){for(var d=[],e=a.split("."),f=b.split("."),g=e[1];g<=f[1];g++)c?d.push({id:e[0]+"."+g,title:e[0]+"."+g}):d.push(g);return d}},compareVersion:function(a,b){var c=a.split("."),d=b.split(".");if(c.length<1)return 1;for(var e=0;e<c.length;e++)try{var a=parseInt(c[e]);if(d.length<e+1)return 2;var b=parseInt(d[e]);if(a>b)return 2;if(a==b)continue;return 1}catch(f){return 1}return 0},SiteHelper:{getSitePrefix:function(){var a=Core.Utility.Utility.UrlHelper.parseUrl(document.location.href).hostname.toUpperCase();if(!a)return"us";switch(a=a.split("."),"array"===$.type(a)&&(a=a.shift()),a){case"CNBETA":case"CNSANDBOX":return"cn";case"127":return"local";default:return"us"}}},BrowserHelper:{getBrowserProfile:function(){var a,b={},c=navigator.appName,d=navigator.userAgent,e=d.match(/(Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile|Mobile)\/?\s*(\.?\d+(\.\d+)*)/i),f=d.match(/(opera|chrome|safari|firefox|msie|Trident)\/?\s*(\.?\d+(\.\d+)*)/i);if(e)switch(f&&null!=(a=d.match(/version\/([\.\d]+)/i))&&(f[2]=a[1]),f=f?[f[1],f[2]]:[c,navigator.appVersion,"-?"],b={name:f[0].toLowerCase(),version:f[1],isCompatible:!1,isMobile:!0,prefix:""},f[0].toLowerCase()){case"opera":b.prefix="-o",b.minVersion="12.12",Core.Utility.Utility.compareVersion("12.12",f[1])<2&&(b.isCompatible=!0);break;case"chrome":b.prefix="-webkit",b.minVersion="23.0.1271.97",Core.Utility.Utility.compareVersion("23.0.1271.97",f[1])<2&&(b.isCompatible=!0);break;case"safari":b.prefix="-webkit",b.minVersion="6.0.2",Core.Utility.Utility.compareVersion("6.0.2",f[1])<2&&(b.isCompatible=!0);break;case"firefox":b.prefix="-moz",b.minVersion="16.0.2",Core.Utility.Utility.compareVersion("16.0.2",f[1])<2&&(b.isCompatible=!0);break;case"msie":b.prefix="-ms",b.isCompatible=!1;break;case"trident":d.indexOf("Windows NT 10")>-1?(b.prefix="-ms",b.minVersion="12.0",b.isCompatible=!0):b.isCompatible=!1}else switch(f&&null!=(a=d.match(/version\/([\.\d]+)/i))&&(f[2]=a[1]),f=f?[f[1],f[2]]:[c,navigator.appVersion,"-?"],b={name:f[0].toLowerCase(),version:f[1],isCompatible:!1,isMobile:!1,minVersion:"",prefix:""},f[0].toLowerCase()){case"opera":b.prefix="-o",b.minVersion="12.12",Core.Utility.Utility.compareVersion("12.12",f[1])<2&&(b.isCompatible=!0);break;case"chrome":b.prefix="-webkit",b.minVersion="30.0",Core.Utility.Utility.compareVersion("30.0",f[1])<2&&(b.isCompatible=!0);break;case"safari":b.prefix="-webkit",b.minVersion="7.0",Core.Utility.Utility.compareVersion("7.0",f[1])<2&&(b.isCompatible=!0);break;case"firefox":b.prefix="-moz",b.minVersion="26.0",Core.Utility.Utility.compareVersion("26.0",f[1])<2&&(b.isCompatible=!0);break;case"msie":b.prefix="-ms",b.isCompatible=!1;break;case"trident":d.indexOf("Windows NT 10")>-1?(b.prefix="-ms",b.minVersion="12.0",b.isCompatible=!0):b.isCompatible=!1}return b.os="unknown",-1!=navigator.appVersion.indexOf("Win")&&(b.os="windows"),-1!=navigator.appVersion.indexOf("Mac")&&(b.os="mac"),-1!=navigator.appVersion.indexOf("X11")&&(b.os="unix"),-1!=navigator.appVersion.indexOf("Linux")&&(b.os="linux"),b}},getUrlParameter:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.href);return null==d?"":decodeURIComponent(d[1])},redirectTo:function(a,b){for(var c=a+"?",d=0;d<b.length;d++)if(""!=b[d].key&&b[d].values){var e="";e="string"==typeof b[d].values?b[d].values:JSON.stringify(b[d].values),""!=e&&(c+=0==d?b[d].key+"="+e:"&"+b[d].key+"="+e)}window.location=c},findPosition:function(a){var b=a,c=0;if(a.offsetParent)for(;;){if(c+=a.offsetTop,!a.offsetParent)break;a=a.offsetParent}else a.y&&(c+=a.y);a=b;var d=0;if(a.offsetParent)for(;;){if(d+=a.offsetLeft,!a.offsetParent)break;a=a.offsetParent}else a.x&&(d+=a.x);return{x:d,y:c}},ClipboardHelper:{putData:function(a){var b=$("<input>");$("body").append(b),b.val(a).select(),document.execCommand("copy"),b.remove()}},CapacityHelper:{getMegaFromKB:function(a){return a/1048576>1024?Math.floor(a/1073741824)+SystemConfig.localization.getString("USSTRING_00049"):a/1024>1024?Math.floor(a/1048576)+SystemConfig.localization.getString("USSTRING_00048"):Math.floor(a/1024)+SystemConfig.localization.getString("USSTRING_00047")}},DateTimeHelper:{GetMilliSeconds:function(a,b){var c;switch(a?(c=new Date,"string"===$.type(a)?c=a.replace(/-/g,"/"):"object"===$.type(a)?a.time?(""===a.time.hour&&(a.time.hour=0,a.time.minute=0),c=a.date.replace(/-/g,"/")+" "+a.time.hour+":"+a.time.minute+":00"):c=a.date.replace(/-/g,"/")+" 00:00:00":c=a):c=(new Date).getTime(),b){case"UTC":c=new Date(c).getTime()+60*(new Date).getTimezoneOffset()*1e3;break;case"local":c=new Date(c).getTime()-60*(new Date).getTimezoneOffset()*1e3;break;default:c=new Date(c).getTime()}return c},ShowDateTime:function(a){return a&&a.date?a.time?a.time.sec?new Date(a.date.replace(/-/g,"/")+" "+a.time.hour+":"+a.time.min+":"+a.time.sec).format(SystemConfig.localizationer.getString("DATETIMEFORMAT_0002")):new Date(a.date.replace(/-/g,"/")+" "+a.time.hour+":"+a.time.min+":00").format(SystemConfig.localizationer.getString("DATETIMEFORMAT_0003")):new Date(a.date.replace(/-/g,"/")).format(SystemConfig.localizationer.getString("DATETIMEFORMAT_0001")):"wrong format"},ShowTime:function(a){return a?a.hour+":"+a.min:void 0}},TimeHelper:{getTickCount:function(a){if(a)var b=new Date(a.replace(/-/g,"/"));else var b=new Date;return b.getTime()},getLocalTime:function(a,b){var c=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDay(),b.getUTCHours(),b.getMinutes(),b.getUTCSeconds());return new Date(c.getTime()+60*a*60*1e3)},parseTimeBySecond:function(a,b){var c=parseInt(a),d=Math.floor(c/3600),e=Math.floor(c%3600/60),f=c%3600%60;return b?(10>d&&(d="0"+d.toString()),10>e&&(e="0"+e.toString()),10>f&&(f="0"+f.toString()),{hour:d.toString(),min:e.toString(),sec:f.toString()}):{hour:d,min:e,sec:f}},getFormatDateTime:function(a){var b=new Date;return b.format(a)},getNowDateTime:function(){var a=new Date,b=a.getMonth()+1,c=a.getDate(),d=a.getHours(),e=a.getMinutes(),f=a.getSeconds();return a.getFullYear()+"/"+(10>b?"0":"")+b+"/"+(10>c?"0":"")+c+" "+(10>d?"0":"")+d+":"+(10>e?"0":"")+e+":"+(10>f?"0":"")+f}},DateHelper:{dateParse:function(a,b){b||(b="-");var c=new RegExp(b,"g");return new Date(a.replace(c,"/"))},dateReplace:function(a,b){b||(b="-");var c=new RegExp(b,"g");return a.replace(c,"/")},dateDiff:function(a,b){var c=Date.parse(a.replace(/-/g,"/")),d=Date.parse(b.replace(/-/g,"/"));return Math.round((d-c)/864e5)}},ColorHelper:{convertHextoRGBA:function(a){try{return"rgba("+parseInt(a.substring(0,2),16)+","+parseInt(a.substring(2,4),16)+","+parseInt(a.substring(4,6),16)+","+parseInt(a.substring(6,8),16)/255+")"}catch(b){}},convertHextoRGBA2:function(a){try{return"rgba("+parseInt(a.substring(2,4),16)+","+parseInt(a.substring(4,6),16)+","+parseInt(a.substring(6,8),16)+","+parseInt(a.substring(0,2),16)/255+")"}catch(b){}},convertRGBtoHex:function(a){return a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2)}},CookieHelper:{createCookie:function(a,b,c,d){Core.Utility.Utility.CookieHelper.deleteCookie(a);var e=new Date;e.setTime(e.getTime()+864e5*(c?c:1)),document.cookie=a+"="+encodeURIComponent(JSON.stringify(b))+"; expires="+e.toGMTString()+"; path="+d},getCookieValue:function(a){var b=document.cookie.indexOf(";",a);return-1==b&&(b=document.cookie.length),document.cookie.substring(a,b)},getCookie:function(a){for(var b=a+"=",c=b.length,d=document.cookie.length,e=0;d>e;){var f=e+c;if(document.cookie.substring(e,f)==b)return JSON.parse(decodeURIComponent(Core.Utility.Utility.CookieHelper.getCookieValue(f)));if(e=document.cookie.indexOf(" ",e)+1,0==e)break}return null},updateCookie:function(a,b,c){var d=Core.Utility.Utility.CookieHelper.getCookie(a);if(d.length<1)return!1;var e=JSON.parse(decodeURIComponent(d));for(prop in b)void 0!=e[prop]&&(e[prop]=b[prop]);var f=new Date;f.setTime(f.getTime()+864e5*(c?c:1)),document.cookie=a+"="+encodeURIComponent(JSON.stringify(e))+"; expires="+f.toGMTString()+"; path=/"},deleteCookie:function(a){var b=new Date;b.setTime(b.getTime()-1),document.cookie=a+"=; expires="+b.toGMTString()+"; path=/"}},LocalStorageHelper:{getValue:function(a){var b=window.localStorage.getItem(a);return"undefined"==b?"":b},setValue:function(a,b){try{return window.localStorage.setItem(a,b),!0}catch(c){return!1}},removeKey:function(a){window.localStorage.removeItem(a)},clear:function(){window.localStorage.clear()},getWindowDimension:function(a,b){var c=b.Duplicate(),d=Core.Utility.Utility.LocalStorageHelper.getValue(a);return void 0!=d&&""!=d&&(b.setStyle(d),b.IsEmpty())?c:b}},NumberHelper:{generateArray:function(a,b,c,d){var e=[];d||(d=1);for(var f=a;b>=f;f+=d)e.push({id:f,title:f.toString()+(c?c:"")});return e},formatCurrency:function(a){try{return parseFloat(a).toFixed(2).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}catch(b){return console.log(b),""}},getDimension:function(a){return""===a.w||""===a.h||""===a.d?null:a.w+"*"+a.h+"*"+a.d},formatFloat:function(a,b){try{var c=Math.pow(10,b);return Math.round(a*c)/c}catch(d){}},numberToEnglish:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=a.toString(),p=b||"";if(0===parseInt(o))return"zero";for(c=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],d=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],e=["","thousand","million","billion","trillion","quadrillion","quintillion","sextillion","septillion","octillion","nonillion","decillion","undecillion","duodecillion","tredecillion","quatttuor-decillion","quindecillion","sexdecillion","septen-decillion","octodecillion","novemdecillion","vigintillion","centillion"],f=o.length,h=[];f>0;)g=f,h.push(o.slice(f=Math.max(0,f-3),g));if(i=h.length,i>e.length)return"";for(n=[],l=0;i>l;l++)j=parseInt(h[l]),j&&(k=h[l].split("").reverse().map(parseFloat),1===k[1]&&(k[0]+=10),(m=e[l])&&n.push(m),(m=c[k[0]])&&n.push(m),(m=d[k[1]])&&n.push(m),(k[0]||k[1])&&(k[2]||!l&&i)&&n.push(p),(m=c[k[2]])&&n.push(m+" hundred"));return n.reverse().join(" ")}},UrlHelper:{parseUrl:function(a){var b=a.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return b&&{protocol:b[1],host:b[2],hostname:b[3],port:b[4],pathname:b[5],search:b[6],hash:b[7]}}},EmailHelper:{validateEmail:function(a){if(""==a)return-1;var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)?1:-2}},VerifyHelper:{verifyNAID:function(a){if(tab="ABCDEFGHJKLMNPQRSTUVXYWZIO",A1=new Array(1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3),A2=new Array(0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5),Mx=new Array(9,8,7,6,5,4,3,2,1,1),10!=a.length)return!1;if(i=tab.indexOf(a.charAt(0)),-1==i)return!1;for(sum=A1[i]+9*A2[i],i=1;i<10;i++){if(v=parseInt(a.charAt(i)),isNaN(v))return!1;sum+=v*Mx[i]}return sum%10!=0?!1:!0},verifyTaxID:function(a){var b="00000000,11111111";if(0==/^\d{8}$/.test(a)||-1!=b.indexOf(a))return!1;for(var c=[1,2,1,2,1,2,4,1],d=0,e=function(a){var b=a%10,c=(a-b)/10;return b+c},f=0;f<c.length;f++)d+=e(a[f]*c[f]);return d%10==0||"7"==a[6]&&(d+1)%10==0}},IPHelper:{getLocalIP:function(a){return $.get("http://ipinfo.io",function(a){},"jsonp")}}},Core.Utility.ImageUtility={},Core.Utility.ImageUtility.Image=function(a){var b=this,c="";Core.Utility.ImageUtility.Image.superclass.constructor.call(this),this.LoadImage=function(a,d,e,f,g){this.setParent(a),c=e;var h=Core.Utility.ImageUtility.Image.superclass.createContainer.call(this,"<img/>");f&&h.css(f),b.addToParent();var i=d&&d.length>0?d.split("."):[""];i.length>0&&(i=i.pop()),h.on("error",function(){h.remove(),c&&(h=$("<img/>").attr({src:c}).appendTo(b.getParent())),b.execute("OnError",b.getParent())}).attr("src",d+"?a="+Core.getGUID())}},Core.extend(Core.Utility.ImageUtility.Image,Core.BaseControl,{OnError:"",OnLoaded:""}),Core.Control.Bottommenus={},Core.Control.Bottommenus.Bottommenu=function(a){function b(a){for(var b=100/a.cols,d=100%a.cols,f=0;f<a.cols.length;f++){var g=$("<div/>").addClass("col").css({width:f==a.cols.length-1?b+d+"%":b+"%"}).appendTo(e);if($("<div/>").addClass("title").text(a.cols[f].title).appendTo(g),a.cols[f].menus)for(var h=0;h<a.cols[f].menus.length;h++)if(a.cols[f].menus[h].href){var i=void 0;"link"==a.cols[f].menus[h].act?i=$("<div/>").addClass("envelop").data({"data-href":a.cols[f].menus[h].href}).appendTo(g).click(c):"crosslink"==a.cols[f].menus[h].act?i=$("<div/>").addClass("envelop").data({"data-href":a.cols[f].menus[h].href}).appendTo(g).click(c):"mailto"==a.cols[f].menus[h].act&&(i=$("<div/>").addClass("envelop").data({"data-href":a.cols[f].menus[h].href}).appendTo(g).click(c)),a.cols[f].menus[h].icon?$("<div/>").addClass("icon "+a.cols[f].menus[h].icon).appendTo(i):$("<div/>").addClass("icon icon-envelop").css({opacity:0}).appendTo(i),$("<div/>").addClass("subtitle").text(a.cols[f].menus[h].title).appendTo(i)}else if("simdlogo"==a.cols[f].menus[h].icon)var i=$("<img/>").attr({src:"res/images/common/SIMD.svg"}).css({position:"relative","float":"left",width:100,height:"auto"}).appendTo(g);else{var i=$("<div/>").addClass("envelop").data({"data-href":a.cols[f].menus[h].href}).appendTo(g);a.cols[f].menus[h].icon?$("<div/>").addClass("icon "+a.cols[f].menus[h].icon).appendTo(i):$("<div/>").addClass("icon icon-envelop").css({opacity:0}).appendTo(i),$("<div/>").addClass("subtitle").text(a.cols[f].menus[h].title).appendTo(i)}}}function c(a){var b=$(this),c=b.data("data-href"),d=b.data("data-target");c&&window.open(c,d?d:"_blank")}Core.Control.Bottommenus.Bottommenu.superclass.constructor.call(this);var d={css:{}};a&&Core.Utility.Utility.JSONHelper.AssignValue(d,a,!0);var e=void 0;this.Attach=function(a,c){switch(e=Core.Control.Bottommenus.Bottommenu.superclass.createContainer.call(this,"<div/>","bottommenus",d.css),c.getRole()){case Core.UserProfile.RoleTypes.customer:case Core.UserProfile.RoleTypes.spadmin:case Core.UserProfile.RoleTypes.spmanager:case Core.UserProfile.RoleTypes.spop:default:var f={cols:[{title:"聯絡我們",menus:[{icon:"icon-envelop",title:"寫信給DONKEY MOVE",act:"mailto",href:"mailto:hostmaster@donkeymove.com"},{icon:"icon-phone",title:"04-24527270",act:"none"},{icon:"icon-clock2",title:"AM 9 - PM 5",act:"none"}]},{title:"服務",menus:[{icon:"icon-hospital",title:"醫療院所接送服務",href:"servicetransporting.html",act:"link"}]},{title:"政策與最新消息",menus:[{icon:"icon-news",title:"國家政策",href:"regulation.html",act:"link"},{icon:"icon-msg",title:"最新消息",href:"news.html",act:"link"}]},{title:"關於我們",menus:[{icon:"icon-signinfo",title:"關於DONKEY MOVE",href:"about.html",act:"link"},{icon:"icon-copyright",title:"Copyright 2018"},{icon:"simdlogo"}]}]};b(f)}a.append(e)}},Core.extend(Core.Control.Bottommenus.Bottommenu,Core.BaseControl,{OnSelect:""}),Core.Control.Topmenus={},Core.Control.Topmenus.Topmenu=function(a){function b(a){r.empty(),$("<div/>").addClass("collapsebtn_"+q.theme+" icon-menu2").appendTo(r).click(d);var b=$("<ul/>").addClass("menutree").appendTo(r);switch(v=[],a.getRole()){case Core.UserProfile.RoleTypes.customer:v.push({id:"order",title:"訂車與查詢請按此",child:[{id:"myorder",title:"新增訂車與近期訂單查詢",href:"cusbookingmgmt.html"},{id:"cusorderhistory",title:"直接輸入單號查詢歷史訂單",href:"cusorderhistory.html"}]}),v.push({id:"pthumb",title:"設定",child:[{id:"profile",title:SystemConfig.localizationer.getString("MENU_0017"),href:"cusdashboard.html"},{id:"profile",title:"我的資料",href:"cuseditprofile.html"},{id:"resetsppws",action:"resetcuspws",title:"重設密碼",href:""},{id:"logout",title:"登出",action:"logout",href:"index.html"}]});break;case Core.UserProfile.RoleTypes.spadmin:case Core.UserProfile.RoleTypes.spmanager:case Core.UserProfile.RoleTypes.spop:v.push({id:"order",title:"訂單",child:[{id:"sptrnasordermgmt",title:"接送訂單管理",href:"spbookingmgmt.html"},{id:"sporderhistory",title:"訂單歷程",href:"sporderhistory.html"}]}),v.push({id:"dispatch",title:"任務調度",child:[{id:"transdispatch",title:SystemConfig.localizationer.getString("FORM_DISPATCH_0001"),href:"spdispatch.html"},{id:"whereismycar",title:"車輛位置圖",href:"spcarposition.html"}]}),v.push({id:"mgmt",title:"管理",child:[{id:"casemgmt",title:"個案管理",href:"spcasemgmt.html"},{id:"fleetmgmt",title:"車籍配對管理",href:"spfleetmgmt.html"},{id:"drivermgmt",title:"司機管理",href:"spdrivermgmt.html"},{id:"carmgmt",title:"車輛管理",href:"spcarmgmt.html"},{id:"staffmgmt",title:"員工管理",href:"spstaffmgmt.html"}]}),v.push({id:"reports",title:"報表",child:[{id:"bookingreport",title:"接送訂單報表",href:"spreporttransbooking.html"},{id:"driverreport",title:"司機報表",href:"spreportdriver.html"},{id:"carreport",title:"車輛報表",href:"spreportcar.html"},{id:"carcheckreport",title:"車輛檢查報表",href:"spcarcheckmgmt.html"}]}),v.push({id:"pthumb",title:"設定",child:[{id:"profile",title:"任務控制台",href:"spdashboard.html"},{id:"profile",title:"個人資料",href:"spstaffprofile.html"},{id:"resetsppws",action:"resetsppws",title:"重設密碼",href:""},{id:"line"},{id:"comprofile",title:"公司資訊",href:"speditprofile.html"},{id:"line"},{id:"logout",title:"登出",action:"logout",href:"index.html"}]});break;case Core.UserProfile.RoleTypes.sys:v.push({id:"order",title:"訂單查詢",child:[{id:"admintrnasordermgmt",title:"接送訂單查詢",href:"adminbookingmgmt.html"},{id:"adminorderhistory",title:"訂單歷程",href:"adminorderhistory.html"}]}),v.push({id:"order",title:"調度查詢",child:[{id:"admindispatchmgmt",title:"調度查詢",href:"adminshipmentmgmt.html"}]}),v.push({id:"query",title:"資料查詢",child:[{id:"spcasemgmt",title:"服務單位個案查詢",href:"admincasemgmt.html"},{id:"syscasemgmt",title:"系統個案查詢",href:"adminregcasemgmt.html"},{id:"fleetmgmt",title:"車籍配對查詢",href:"adminfleetmgmt.html"},{id:"drivermgmt",title:"司機查詢",href:"admindrivermgmt.html"},{id:"carmgmt",title:"車輛查詢",href:"admincarmgmt.html"},{id:"staffmgmt",title:"員工查詢",href:"adminstaffmgmt.html"}]}),v.push({id:"mgmt",title:"資料管理",child:[{id:"spmgmt",title:"服務單位管理",href:"adminspmgmt.html"},{id:"ratemgmt",title:"費用管理",href:"adminratemgmt.html"},{id:"hosmgmt",title:"醫院管理",href:"adminhosmgmt.html"},{id:"membermgmt",title:"管理員帳號管理",href:"adminmembermgmt.html"}]}),v.push({id:"report",title:"報表",child:[{id:"\badmincityreport",title:"全國月報表",href:"admincityreport.html"},{id:"\badmincitydistrictreport",title:"縣市月報表",href:"admincitydistrictreport.html"}]}),v.push({id:"pthumb",title:"設定",child:[{id:"profile",title:"任務控制台",href:"admindashboard.html"},{id:"profile",title:"管理員資料",href:"adminstaffprofile.html"},{id:"resetsppws",action:"resetadminpws",title:"重設密碼",href:""},{id:"logout",title:"登出",action:"logout",href:"index.html"}]});break;case Core.UserProfile.RoleTypes.driver:break;default:v.push({id:"home",title:"首頁",href:"index.html"}),v.push({id:"services",title:"服務內容",child:[{id:"p001",title:"醫療院所接送",href:"servicetransporting.html"}]}),v.push({id:"login",title:"登入",child:[{id:"cuslogin",title:"個案登入",href:"cuslogin.html"},{id:"cusregister",title:"個案註冊",href:"cusregister.html"},{id:"splogin",title:"服務單位登入",href:"splogin.html"}]})}for(var c=0;c<v.length;c++)if(v[c].child&&v[c].child.length>0)if("pthumb"==v[c].id){var g=$("<li/>").addClass("menuitem_"+q.theme).css({padding:0}).data({data:v[c]}).appendTo(b).hover(e,f),h=$("<div/>").addClass("pthumb icon-usermgmt").appendTo(g).tooltipster({content:Core.Utility.Utility.TooltipHelper.GenerateToolTip([{title:"",text:SystemConfig.UserProfile.getFullName()}])}),i=new Core.Utility.ImageUtility.Image;i.LoadImage(h,SystemConfig.UserProfile.getThumb())}else $("<li/>").addClass("menuitem_"+q.theme).text(v[c].title).data({data:v[c]}).appendTo(b).hover(e,f);else $("<li/>").addClass("menuitem_"+q.theme).text(v[c].title).data({data:v[c]}).appendTo(b).click(n);$(window).resize(o),o()}function c(){b(SystemConfig.UserProfile)}function d(){t=$("<div/>").addClass("rwdslider rwdslider_slideleft").click(m);for(var a=$("<div/>").addClass("panel").appendTo(t).click(m),b=$("<div/>").addClass("menulist").appendTo(a),c=0;c<v.length;c++)if(v[c].child&&v[c].child.length>0){if("login"!=v[c].id)for(var d=($("<div/>").addClass("catmenu").text(v[c].title).data({data:v[c]}).appendTo(b),0);d<v[c].child.length;d++)$("<div/>").addClass("menu").data({data:v[c].child[d]}).text(v[c].child[d].title).appendTo(b).click(g)}else $("<div/>").addClass("catmenu enable").text(v[c].title).data({data:v[c]}).appendTo(b).click(n);t.appendTo($("body")),u="mobile"}function e(a){var b=$(this),c=b.data("data").child;if(c&&c.length>0){s&&s.empty().remove(),s=$("<div/>").addClass("childmenus_"+q.theme).css({right:b.parent().width()-b.position().left-b.width(),top:70,width:"max-content"}).appendTo(b);for(var d=$("<ul/>").appendTo(s),e=0;e<c.length;e++)"line"==c[e].id?$("<li/>").addClass("line").appendTo(d):$("<li/>").text(c[e].title).data({data:c[e]}).appendTo(d).click(g)}s.css({opacity:1})}function f(a){s&&s.empty().remove()}function g(a){var b=$(this),c=b.data("data");if(c.action)switch(c.action){case"logout":i(c);break;case"resetsppws":k();break;case"resetcuspws":l();break;case"resetadminpws":j()}else c.href?window.open(c.href,"_blank"):p.execute(OnSelect,c.id);"web"==u?f():h()}function h(){t&&(t.bind("mozAnimationEnd webkitAnimationEnd msAnimationEnd oAnimationEnd animationend mozAnimationEnd",function(a){t.unbind("mozAnimationEnd webkitAnimationEnd msAnimationEnd oAnimationEnd animationend mozAnimationEnd"),t.remove(),t=void 0}),t.addClass("rwdslider_slideright"))}function i(a){var b=new Core.Control.Dialogs.MessageDialog;b.ShowDialog(SystemConfig.localizationer.getString("COMMON_TEXT_0009"),"alert",[{type:"CANCEL",title:SystemConfig.localizationer.getString("BUTTON_0002")},{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}]),b.addEventListener("OnOK",function(){switch(SystemConfig.UserProfile.getRole()){case Core.UserProfile.RoleTypes.sys:var b=new Core.Communication.CommnicateAgent(!0);b.addEventListener("OnData",function(b){SystemConfig.UserProfile.Logout(),window.location.href=a.href}),b.addEventListener("OnError",function(b){SystemConfig.UserProfile.Logout(),window.location.href=a.href}),b.PostData(Core.RequestUrl.getUrl("adminsignout"),{});break;case Core.UserProfile.RoleTypes.spadmin:case Core.UserProfile.RoleTypes.spmanager:case Core.UserProfile.RoleTypes.spop:var b=new Core.Communication.CommnicateAgent(!0);b.addEventListener("OnData",function(b){SystemConfig.UserProfile.Logout(),window.location.href=a.href}),b.addEventListener("OnError",function(b){SystemConfig.UserProfile.Logout(),window.location.href=a.href}),b.PostData(Core.RequestUrl.getUrl("spsignout"),{});break;case Core.UserProfile.RoleTypes.customer:var b=new Core.Communication.CommnicateAgent(!0);b.addEventListener("OnData",function(b){SystemConfig.UserProfile.Logout(),window.location.href=a.href}),b.addEventListener("OnError",function(b){SystemConfig.UserProfile.Logout(),window.location.href=a.href}),b.PostData(Core.RequestUrl.getUrl("cussignout"),{});break;case Core.UserProfile.RoleTypes.driver:alert("Never Implement")}})}function j(){var a=new Core.Control.Dialogs.CustomizeDialog;a.ShowDialog({top:0,bottom:100,height:"auto"},SystemConfig.localizationer.getString("FORM_CHANGE_PASSWORD_0001"),[{type:"CANCEL",title:SystemConfig.localizationer.getString("BUTTON_0002")},{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}]),a.addEventListener("OnOK",function(){var a=new Core.Control.Dialogs.MessageDialog;a.ShowDialog("密碼修改成功!","info",[{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}])});var b=new Core.Control.Forms.FormSPChangePassword({type:"me",url:Core.RequestUrl.getUrl("adminchpws"),guid:SystemConfig.UserProfile.getGUID()});a.AddContent(b)}function k(){var a=new Core.Control.Dialogs.CustomizeDialog;a.ShowDialog({top:0,bottom:100,height:"auto"},SystemConfig.localizationer.getString("FORM_CHANGE_PASSWORD_0001"),[{type:"CANCEL",title:SystemConfig.localizationer.getString("BUTTON_0002")},{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}]),a.addEventListener("OnOK",function(){});var b=new Core.Control.Forms.FormSPChangePassword({type:"me",url:Core.RequestUrl.getUrl("spchpws"),guid:SystemConfig.UserProfile.getGUID()});a.AddContent(b)}function l(){var a=new Core.Control.Dialogs.CustomizeDialog;a.ShowDialog({top:0,bottom:100,height:"auto"},SystemConfig.localizationer.getString("FORM_CHANGE_PASSWORD_0001"),[{type:"CANCEL",title:SystemConfig.localizationer.getString("BUTTON_0002")},{type:"OK",title:SystemConfig.localizationer.getString("BUTTON_0001")}]);var b=new Core.Control.Forms.FormSPChangePassword({type:"me",url:Core.RequestUrl.getUrl("cuschpws"),guid:SystemConfig.UserProfile.getGUID()});a.AddContent(b)}function m(a){a.stopPropagation();var b=$(this);b.get(0)==t.get(0)&&h()}function n(a){var b=$(this),c=b.data("data");c.href?window.location=c.href:p.execute("OnSelect",c.id)}function o(a){var b=$(window).outerWidth();a&&(b=a.target.outerWidth),b>1365?($(".sysalert").text("").hide(),$(".topmenus .menutree").css({marginRight:20}).show(),$(".collapsebtn_std").css({display:"none"}),$(".collapsebtn_bb").css({display:"none"}),$(".collapsebtn_bw").css({display:"none"}),$(".collapsebtn_og").css({display:"none"})):($(".sysalert").text("為了獲得最佳的顯示，網頁登入要求最少1366解析度").show(),$(".topmenus .menutree").css({marginRight:0}).hide(),$(".topmenus .collapsebtn_std").css({display:"block"}),$(".topmenus .collapsebtn_bb").css({color:"white",display:"block"}),$(".topmenus .collapsebtn_bw").css({display:"block"}),$(".topmenus .collapsebtn_og").css({color:"white",display:"block"}))}var p=this;Core.Control.Topmenus.Topmenu.superclass.constructor.call(this);var q={attr:{},css:{"float":"right"},theme:"std"};a&&Core.Utility.Utility.JSONHelper.AssignValue(q,a,!0);var r,s,t,u="web",v=[];this.Attach=function(a){r=Core.Control.Topmenus.Topmenu.superclass.createContainer.call(this,"<div/>","topmenus",q.css),SystemConfig.UserProfile.addEventListener("OnUpdate",c),b(SystemConfig.UserProfile),a.append(r)}},Core.extend(Core.Control.Topmenus.Topmenu,Core.BaseControl,{OnSelect:""});var modulemap={modules:[],classes:[]},mloader=new Core.ModuleLoader;mloader.LoadModule(modulemap,function(){SystemConfig.UserProfile=new Core.UserProfile.userProfile(!0,Core.UserProfile.sessioncats.none,!0),mloader.LoadLanguage("zh-tw","Localization/lang-",function(a){SystemConfig.localization=a;var b=new Core.Control.Topmenus.Topmenu({theme:"bw"});b.Attach($("#topbar"),SystemConfig.UserProfile);var c=new Core.Control.Bottommenus.Bottommenu;c.Attach($("#bottombar"),SystemConfig.UserProfile)},function(){})},function(a){});var lastscrolltop=0;window.onscroll=function(a){this.lastscrolltop>this.scrollY?$("#topbar").css({"background-color":"rgba(0,0,0,0)"}):$("#topbar").css({"background-color":"rgba(0,0,0,.2)"}),lastscrolltop=this.scrollY};